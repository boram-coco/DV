<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.283">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="김보람">
<meta name="dcterms.date" content="2022-10-24">

<title>DV - DV 8주차</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DV</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">DV 8주차</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">pandas</div>
                <div class="quarto-category">자료 분석</div>
                <div class="quarto-category">PLOTNINE</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>김보람 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 24, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div id="59353dff-df7d-40c9-a60e-7dae56a95519" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pandas_profiling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Collecting pandas_profiling
  Downloading pandas_profiling-3.6.6-py2.py3-none-any.whl (324 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 324.4/324.4 kB 13.2 MB/s eta 0:00:00
Collecting ydata-profiling
  Downloading ydata_profiling-4.0.0-py2.py3-none-any.whl (344 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 344.5/344.5 kB 43.0 MB/s eta 0:00:00
Collecting typeguard&lt;2.14,&gt;=2.13.2
  Downloading typeguard-2.13.3-py3-none-any.whl (17 kB)
Requirement already satisfied: statsmodels&lt;0.14,&gt;=0.13.2 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from ydata-profiling-&gt;pandas_profiling) (0.13.5)
Requirement already satisfied: scipy&lt;1.10,&gt;=1.4.1 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from ydata-profiling-&gt;pandas_profiling) (1.7.3)
Requirement already satisfied: jinja2&lt;3.2,&gt;=2.11.1 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from ydata-profiling-&gt;pandas_profiling) (3.1.2)
Collecting PyYAML&lt;6.1,&gt;=5.0.0
  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 596.3/596.3 kB 68.7 MB/s eta 0:00:00
Collecting phik&lt;0.13,&gt;=0.11.1
  Downloading phik-0.12.3-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (680 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 680.0/680.0 kB 36.1 MB/s eta 0:00:00
Collecting multimethod&lt;1.10,&gt;=1.4
  Downloading multimethod-1.9.1-py3-none-any.whl (10 kB)
Collecting pydantic&lt;1.11,&gt;=1.8.1
  Downloading pydantic-1.10.5-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.1/3.1 MB 78.6 MB/s eta 0:00:00:00:01
Requirement already satisfied: matplotlib&lt;3.7,&gt;=3.2 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from ydata-profiling-&gt;pandas_profiling) (3.5.3)
Requirement already satisfied: pandas!=1.4.0,&lt;1.6,&gt;1.1 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from ydata-profiling-&gt;pandas_profiling) (1.3.5)
Collecting htmlmin==0.1.12
  Downloading htmlmin-0.1.12.tar.gz (19 kB)
  Preparing metadata (setup.py) ... done
Requirement already satisfied: numpy&lt;1.24,&gt;=1.16.0 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from ydata-profiling-&gt;pandas_profiling) (1.21.6)
Requirement already satisfied: seaborn&lt;0.13,&gt;=0.10.1 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from ydata-profiling-&gt;pandas_profiling) (0.12.2)
Collecting tqdm&lt;4.65,&gt;=4.48.2
  Downloading tqdm-4.64.1-py2.py3-none-any.whl (78 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 78.5/78.5 kB 15.4 MB/s eta 0:00:00
Requirement already satisfied: requests&lt;2.29,&gt;=2.24.0 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from ydata-profiling-&gt;pandas_profiling) (2.28.2)
Collecting visions[type_image_path]==0.7.5
  Downloading visions-0.7.5-py3-none-any.whl (102 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 102.7/102.7 kB 20.6 MB/s eta 0:00:00
Requirement already satisfied: attrs&gt;=19.3.0 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from visions[type_image_path]==0.7.5-&gt;ydata-profiling-&gt;pandas_profiling) (22.2.0)
Collecting networkx&gt;=2.4
  Downloading networkx-2.6.3-py3-none-any.whl (1.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.9/1.9 MB 90.1 MB/s eta 0:00:00
Collecting tangled-up-in-unicode&gt;=0.0.4
  Downloading tangled_up_in_unicode-0.2.0-py3-none-any.whl (4.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.7/4.7 MB 93.1 MB/s eta 0:00:00ta 0:00:01
Requirement already satisfied: Pillow in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from visions[type_image_path]==0.7.5-&gt;ydata-profiling-&gt;pandas_profiling) (9.4.0)
Collecting imagehash
  Downloading ImageHash-4.3.1-py2.py3-none-any.whl (296 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 296.5/296.5 kB 56.5 MB/s eta 0:00:00
Requirement already satisfied: MarkupSafe&gt;=2.0 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from jinja2&lt;3.2,&gt;=2.11.1-&gt;ydata-profiling-&gt;pandas_profiling) (2.1.1)
Requirement already satisfied: packaging&gt;=20.0 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from matplotlib&lt;3.7,&gt;=3.2-&gt;ydata-profiling-&gt;pandas_profiling) (23.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from matplotlib&lt;3.7,&gt;=3.2-&gt;ydata-profiling-&gt;pandas_profiling) (4.38.0)
Requirement already satisfied: cycler&gt;=0.10 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from matplotlib&lt;3.7,&gt;=3.2-&gt;ydata-profiling-&gt;pandas_profiling) (0.11.0)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from matplotlib&lt;3.7,&gt;=3.2-&gt;ydata-profiling-&gt;pandas_profiling) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from matplotlib&lt;3.7,&gt;=3.2-&gt;ydata-profiling-&gt;pandas_profiling) (2.8.2)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from matplotlib&lt;3.7,&gt;=3.2-&gt;ydata-profiling-&gt;pandas_profiling) (1.4.4)
Requirement already satisfied: pytz&gt;=2017.3 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from pandas!=1.4.0,&lt;1.6,&gt;1.1-&gt;ydata-profiling-&gt;pandas_profiling) (2022.7.1)
Collecting joblib&gt;=0.14.1
  Downloading joblib-1.2.0-py3-none-any.whl (297 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 298.0/298.0 kB 52.3 MB/s eta 0:00:00
Requirement already satisfied: typing-extensions&gt;=4.2.0 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from pydantic&lt;1.11,&gt;=1.8.1-&gt;ydata-profiling-&gt;pandas_profiling) (4.4.0)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from requests&lt;2.29,&gt;=2.24.0-&gt;ydata-profiling-&gt;pandas_profiling) (1.26.14)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from requests&lt;2.29,&gt;=2.24.0-&gt;ydata-profiling-&gt;pandas_profiling) (2022.12.7)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from requests&lt;2.29,&gt;=2.24.0-&gt;ydata-profiling-&gt;pandas_profiling) (2.1.1)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from requests&lt;2.29,&gt;=2.24.0-&gt;ydata-profiling-&gt;pandas_profiling) (3.4)
Requirement already satisfied: patsy&gt;=0.5.2 in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from statsmodels&lt;0.14,&gt;=0.13.2-&gt;ydata-profiling-&gt;pandas_profiling) (0.5.3)
Requirement already satisfied: six in /home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages (from patsy&gt;=0.5.2-&gt;statsmodels&lt;0.14,&gt;=0.13.2-&gt;ydata-profiling-&gt;pandas_profiling) (1.16.0)
Collecting PyWavelets
  Downloading PyWavelets-1.3.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.4/6.4 MB 85.2 MB/s eta 0:00:00:00:0100:01
Building wheels for collected packages: htmlmin
  Building wheel for htmlmin (setup.py) ... done
  Created wheel for htmlmin: filename=htmlmin-0.1.12-py3-none-any.whl size=27082 sha256=7bcfaa4b7942dcfb19895abe1a49d1c43c9f2d12c73d8bc74499ddcb933893c8
  Stored in directory: /home/koinup4/.cache/pip/wheels/56/18/c1/6b3058b1db1f804221515aac5ecf2513d5ba971f33b8560c7a
Successfully built htmlmin
Installing collected packages: htmlmin, typeguard, tqdm, tangled-up-in-unicode, PyYAML, PyWavelets, pydantic, networkx, multimethod, joblib, imagehash, visions, phik, ydata-profiling, pandas_profiling
Successfully installed PyWavelets-1.3.0 PyYAML-6.0 htmlmin-0.1.12 imagehash-4.3.1 joblib-1.2.0 multimethod-1.9.1 networkx-2.6.3 pandas_profiling-3.6.6 phik-0.12.3 pydantic-1.10.5 tangled-up-in-unicode-0.2.0 tqdm-4.64.1 typeguard-2.13.3 visions-0.7.5 ydata-profiling-4.0.0</code></pre>
</div>
</div>
<div id="ae70e573-fcd1-4363-ae7c-e2bff83b6612" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas_profiling</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="판다스-새로운-열의-할당-2단계-연쇄할당" class="level1">
<h1>판다스: 새로운 열의 할당 2단계 (연쇄할당)</h1>
<section id="모티브" class="level2">
<h2 class="anchored" data-anchor-id="모티브">모티브</h2>
<p><code>-</code> 원본데이터를 가급적 손상시키지 않으면서 데이터를 변형하고 싶음</p>
<div id="905c9ccc-579f-4ea9-9922-28988e131b64" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>:<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="st">'B'</span>:<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>)})</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>복사본 생성</p>
<div id="29f727ba-51b9-46d7-9c60-b7938c1e2517" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="26a9efbf-7ad8-4b15-98a5-9b6cc335898a" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">'C'</span>] <span class="op">=</span> (df2.A<span class="op">+</span>df2.B)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="be59c8bf-945f-4b04-8349-4584603eb3fe" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">'D'</span>] <span class="op">=</span> (df2.C <span class="op">-</span> np.mean(df2.C))<span class="op">/</span>np.std(df2.C)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
<td>-1.414214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
<td>-0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
<td>0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
<td>1.414214</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="d5860ff0-1458-4476-bd45-7bc8d26e1aa4" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df  <span class="co"># 왜 C랑 D 값이 들어가있노?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
<td>-1.414214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
<td>-0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
<td>0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
<td>1.414214</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><p>shallow copy</p></li>
<li><p>deep copy</p></li>
</ul>
</section>
<section id="해결책1" class="level2">
<h2 class="anchored" data-anchor-id="해결책1">해결책1</h2>
<p><code>-</code> 올바른코드1</p>
<div id="b3fce93f-2407-4aa5-9fe2-d806dd368669" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>:<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="st">'B'</span>:<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>)})</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df.copy() </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">'C'</span>] <span class="op">=</span> (df2.A<span class="op">+</span> df2.B)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">'D'</span>]<span class="op">=</span> (df2.C <span class="op">-</span> np.mean(df2.C))<span class="op">/</span>np.std(df2.C) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="187edaf9-f028-4fd0-9d6c-6bb078c666c5" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
<td>-1.414214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
<td>-0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
<td>0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
<td>1.414214</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f6e47a96-cf28-4341-af6e-2f5fbf8775b5" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> 올바른 코드2 (eval)</p>
<div id="f9da7c7c-dba9-4c88-a034-3c137d06ec11" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">'C=(A+B)/2'</span>).<span class="bu">eval</span>(<span class="st">'D=C-mean(c))/std(C)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TokenError: ('EOF in multi-line statement', (2, 0))</code></pre>
</div>
</div>
<div id="b27cb0e0-9d4a-4d77-8e9d-dfaa9e4e2cda" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mean([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]) <span class="co"># 정의가 안되있으무로</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'mean' is not defined</code></pre>
</div>
</div>
<div id="5440e0f6-ead8-496c-a2aa-37606984796e" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> np.mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="92933059-da84-4ae8-97b8-396235f764bc" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mean([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>2.0</code></pre>
</div>
</div>
<div id="b55e36f9-658d-4c5c-b8a7-089d215f916c" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> np.mean</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>std <span class="op">=</span> np.std</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">'C=(A+B)/2'</span>).<span class="bu">eval</span>(<span class="st">'D=(C-@mean(C))/@std(C)'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 외부에서 온 거란 걸 표시해주기 위해서 mean앞에 @ 붙인다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
<td>-1.414214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
<td>-0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
<td>0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
<td>1.414214</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><p>어디까지 eval expression 안에서 지원되는지 명확하지 않고</p></li>
<li><p>외부에 함수를 선언하고 eval expression 안에 <span class="citation" data-cites="를">@를</span> 붙이는게 가독성이 없다.</p></li>
</ul>
<p><code>-</code> 올바른 코드3 (assign) —-&gt; 실패</p>
<div id="be1dff2a-3427-498a-ab69-9f1ec444cecf" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>:<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="st">'B'</span>:<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>)})</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df.assign(C<span class="op">=</span>(df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="7dce8c57-49b3-4894-a247-dbd321ecec72" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.assign(C<span class="op">=</span>(df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>).assign(D<span class="op">=</span>(df.C<span class="op">-</span>np.mean(df.C))<span class="op">/</span>np.std(df.C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AttributeError: 'DataFrame' object has no attribute 'C'</code></pre>
</div>
</div>
<div id="61ee0024-e9f2-4b17-bcaa-a63d9e685dfc" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.C 하면 나오는 오류와 동일한 오류가 위처럼 나타난다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a4014de3-ccca-494d-a7d4-f3ba912157bf" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.assign(C<span class="op">=</span>(df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>아래와 같이 고쳐야함</p>
<div id="bc8e9055-03fd-4c79-9b4a-cd83feb8d653" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>_df <span class="op">=</span> df.assign(C<span class="op">=</span>(df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>_df.assign(D<span class="op">=</span>(_df.C<span class="op">-</span>np.mean(_df.C))<span class="op">/</span>np.std(_df.C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
<td>-1.414214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
<td>-0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
<td>0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
<td>1.414214</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="해결책2-assign" class="level2">
<h2 class="anchored" data-anchor-id="해결책2-assign">해결책2 (assign)</h2>
<p>실패한 코드</p>
<div id="edf69cfb-7df2-4437-9ebe-704c554e7832" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df.assign(C<span class="op">=</span>(df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>).assign(D<span class="op">=</span>(df.C<span class="op">-</span>np.mean(df.C))<span class="op">/</span>np.std(df.C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AttributeError: 'DataFrame' object has no attribute 'C'</code></pre>
</div>
</div>
<p>두번째 assign에서 표현된 df.C에서 <code>df current df</code> ( = <code>df.assign(C=(df.A+df.B)/2)</code> 까지 연산된 상태) 를 의미하도록 만들고 싶다. <span class="math inline">\(\to\)</span> 아래와 같이 <code>lambda df:</code> 를 추가하면 된다.</p>
<div id="ffd5b8eb-9d26-45c0-918b-efd302dee5d1" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df.assign(C<span class="op">=</span>(df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>).assign(D<span class="op">=</span> <span class="kw">lambda</span> df: (df.C<span class="op">-</span>np.mean(df.C))<span class="op">/</span>np.std(df.C))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
<td>-1.414214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
<td>-0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
<td>0.707107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
<td>1.414214</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> 연쇄할당</p>
<div id="e8a720d3-d298-484b-ae2f-65c65ff43237" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df.assign(C<span class="op">=</span> (df.A<span class="op">+</span>df.B)<span class="op">/</span><span class="dv">2</span>).assign(D<span class="op">=</span> <span class="kw">lambda</span> df:df.C<span class="op">+</span><span class="dv">2</span>).assign(E <span class="op">=</span> <span class="kw">lambda</span> df: df.D <span class="op">-</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">E</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1</td>
<td>0.5</td>
<td>2.5</td>
<td>0.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>1.5</td>
<td>3.5</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>3</td>
<td>2.5</td>
<td>4.5</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>4</td>
<td>3.5</td>
<td>5.5</td>
<td>3.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
<td>4.5</td>
<td>6.5</td>
<td>4.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="fifa23-데이터-분석" class="level1">
<h1>FIFA23 데이터 분석</h1>
<section id="fifa23-data" class="level2">
<h2 class="anchored" data-anchor-id="fifa23-data">FIFA23 DATA</h2>
<p><code>-</code> FIFA23 라는 축구게임이 있음</p>
<p><code>-</code> 선수들의 능력치에 대한 데이터셋은 캐글에 공개 되어 있다.</p>
<p>https://www.kaggle.com/datasets/bryanb/fifa-player-stats-database?select=FIFA23_official_data.csv</p>
</section>
<section id="데이터-살펴보기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-살펴보기">데이터 살펴보기</h2>
<div id="acbfc0d6-d653-42ff-883e-7dc69acf4c05" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/DV2022/main/posts/FIFA23_official_data.csv'</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Real Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>209658</td>
<td>L. Goretzka</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>87</td>
<td>88</td>
<td>FC Bayern München</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Jul 1, 2018</td>
<td>NaN</td>
<td>2026</td>
<td>189cm</td>
<td>82kg</td>
<td>€157M</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>212198</td>
<td>Bruno Fernandes</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>Portugal</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>86</td>
<td>87</td>
<td>Manchester United</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>Jan 30, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>179cm</td>
<td>69kg</td>
<td>€155M</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>224334</td>
<td>M. Acuña</td>
<td>30</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>85</td>
<td>85</td>
<td>Sevilla FC</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>Sep 14, 2020</td>
<td>NaN</td>
<td>2024</td>
<td>172cm</td>
<td>69kg</td>
<td>€97.7M</td>
<td>19.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>NaN</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>€198.9M</td>
<td>17.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Sep 1, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>172cm</td>
<td>68kg</td>
<td>€154.4M</td>
<td>23.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>5 rows × 29 columns</p>
</div>
</div>
</div>
<p>트랜스포즈하여 보는 것이 편할 때도 있다</p>
<div id="0244a3a4-3b85-4bbc-84fe-f14ae18aea04" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">17650</th>
<th data-quarto-table-cell-role="th">17651</th>
<th data-quarto-table-cell-role="th">17652</th>
<th data-quarto-table-cell-role="th">17653</th>
<th data-quarto-table-cell-role="th">17654</th>
<th data-quarto-table-cell-role="th">17655</th>
<th data-quarto-table-cell-role="th">17656</th>
<th data-quarto-table-cell-role="th">17657</th>
<th data-quarto-table-cell-role="th">17658</th>
<th data-quarto-table-cell-role="th">17659</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ID</td>
<td>209658</td>
<td>212198</td>
<td>224334</td>
<td>192985</td>
<td>224232</td>
<td>212622</td>
<td>197445</td>
<td>187961</td>
<td>208333</td>
<td>210514</td>
<td>...</td>
<td>256879</td>
<td>269546</td>
<td>267647</td>
<td>253186</td>
<td>267461</td>
<td>269526</td>
<td>267946</td>
<td>270567</td>
<td>256624</td>
<td>256376</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Name</td>
<td>L. Goretzka</td>
<td>Bruno Fernandes</td>
<td>M. Acuña</td>
<td>K. De Bruyne</td>
<td>N. Barella</td>
<td>J. Kimmich</td>
<td>D. Alaba</td>
<td>22&nbsp;Paulinho</td>
<td>E. Can</td>
<td>João Cancelo</td>
<td>...</td>
<td>22&nbsp;G. Leijon</td>
<td>Wu Fei</td>
<td>22&nbsp;E. Grosz</td>
<td>22&nbsp;S. Booth</td>
<td>22&nbsp;L. Grimpe</td>
<td>Deng Xiongtao</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>A. Demir</td>
<td>21&nbsp;S. Czajor</td>
<td>21&nbsp;F. Jakobsson</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Age</td>
<td>27</td>
<td>27</td>
<td>30</td>
<td>31</td>
<td>25</td>
<td>27</td>
<td>30</td>
<td>32</td>
<td>28</td>
<td>28</td>
<td>...</td>
<td>19</td>
<td>32</td>
<td>18</td>
<td>20</td>
<td>17</td>
<td>19</td>
<td>17</td>
<td>25</td>
<td>18</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Photo</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>https://cdn.sofifa.net/players/212/622/23_60.png</td>
<td>https://cdn.sofifa.net/players/197/445/23_60.png</td>
<td>https://cdn.sofifa.net/players/187/961/22_60.png</td>
<td>https://cdn.sofifa.net/players/208/333/23_60.png</td>
<td>https://cdn.sofifa.net/players/210/514/23_60.png</td>
<td>...</td>
<td>https://cdn.sofifa.net/players/256/879/22_60.png</td>
<td>https://cdn.sofifa.net/players/269/546/23_60.png</td>
<td>https://cdn.sofifa.net/players/267/647/22_60.png</td>
<td>https://cdn.sofifa.net/players/253/186/22_60.png</td>
<td>https://cdn.sofifa.net/players/267/461/22_60.png</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Nationality</td>
<td>Germany</td>
<td>Portugal</td>
<td>Argentina</td>
<td>Belgium</td>
<td>Italy</td>
<td>Germany</td>
<td>Austria</td>
<td>Brazil</td>
<td>Germany</td>
<td>Portugal</td>
<td>...</td>
<td>Sweden</td>
<td>China PR</td>
<td>Romania</td>
<td>England</td>
<td>Germany</td>
<td>China PR</td>
<td>Korea Republic</td>
<td>Turkey</td>
<td>Poland</td>
<td>Sweden</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Flag</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>https://cdn.sofifa.net/flags/at.png</td>
<td>https://cdn.sofifa.net/flags/br.png</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>...</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>https://cdn.sofifa.net/flags/ro.png</td>
<td>https://cdn.sofifa.net/flags/gb-eng.png</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Overall</td>
<td>87</td>
<td>86</td>
<td>85</td>
<td>91</td>
<td>86</td>
<td>89</td>
<td>86</td>
<td>83</td>
<td>82</td>
<td>88</td>
<td>...</td>
<td>52</td>
<td>51</td>
<td>52</td>
<td>51</td>
<td>54</td>
<td>48</td>
<td>48</td>
<td>51</td>
<td>50</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Potential</td>
<td>88</td>
<td>87</td>
<td>85</td>
<td>91</td>
<td>89</td>
<td>90</td>
<td>86</td>
<td>83</td>
<td>82</td>
<td>88</td>
<td>...</td>
<td>62</td>
<td>51</td>
<td>70</td>
<td>60</td>
<td>68</td>
<td>61</td>
<td>64</td>
<td>56</td>
<td>65</td>
<td>61</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Club</td>
<td>FC Bayern München</td>
<td>Manchester United</td>
<td>Sevilla FC</td>
<td>Manchester City</td>
<td>Inter</td>
<td>FC Bayern München</td>
<td>Real Madrid CF</td>
<td>Al Ahli</td>
<td>Borussia Dortmund</td>
<td>Manchester City</td>
<td>...</td>
<td>Örebro SK</td>
<td>Wuhan Three Towns</td>
<td>Gaz Metan Mediaş</td>
<td>Crewe Alexandra</td>
<td>RB Leipzig</td>
<td>Meizhou Hakka</td>
<td>Jeju United FC</td>
<td>Ümraniyespor</td>
<td>Fleetwood Town</td>
<td>IFK Norrköping</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Club Logo</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>https://cdn.sofifa.net/teams/243/30.png</td>
<td>https://cdn.sofifa.net/teams/112387/30.png</td>
<td>https://cdn.sofifa.net/teams/22/30.png</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>https://cdn.sofifa.net/teams/705/30.png</td>
<td>https://cdn.sofifa.net/teams/116361/30.png</td>
<td>https://cdn.sofifa.net/teams/112637/30.png</td>
<td>https://cdn.sofifa.net/teams/121/30.png</td>
<td>https://cdn.sofifa.net/teams/112172/30.png</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Value</td>
<td>€91M</td>
<td>€78.5M</td>
<td>€46.5M</td>
<td>€107.5M</td>
<td>€89.5M</td>
<td>€105.5M</td>
<td>€55.5M</td>
<td>€28.5M</td>
<td>€30.5M</td>
<td>€82.5M</td>
<td>...</td>
<td>€150K</td>
<td>€30K</td>
<td>€180K</td>
<td>€110K</td>
<td>€210K</td>
<td>€100K</td>
<td>€100K</td>
<td>€70K</td>
<td>€90K</td>
<td>€90K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Wage</td>
<td>€115K</td>
<td>€190K</td>
<td>€46K</td>
<td>€350K</td>
<td>€110K</td>
<td>€130K</td>
<td>€220K</td>
<td>€61K</td>
<td>€63K</td>
<td>€250K</td>
<td>...</td>
<td>€500</td>
<td>€2K</td>
<td>€500</td>
<td>€850</td>
<td>€500</td>
<td>€500</td>
<td>€500</td>
<td>€2K</td>
<td>€500</td>
<td>€500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Special</td>
<td>2312</td>
<td>2305</td>
<td>2303</td>
<td>2303</td>
<td>2296</td>
<td>2283</td>
<td>2277</td>
<td>2273</td>
<td>2271</td>
<td>2262</td>
<td>...</td>
<td>779</td>
<td>777</td>
<td>775</td>
<td>768</td>
<td>767</td>
<td>762</td>
<td>761</td>
<td>759</td>
<td>758</td>
<td>749</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Preferred Foot</td>
<td>Right</td>
<td>Right</td>
<td>Left</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>Left</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>...</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>Right</td>
<td>Left</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">International Reputation</td>
<td>4.0</td>
<td>3.0</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>4.0</td>
<td>3.0</td>
<td>3.0</td>
<td>3.0</td>
<td>...</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Weak Foot</td>
<td>4.0</td>
<td>3.0</td>
<td>3.0</td>
<td>5.0</td>
<td>3.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>...</td>
<td>3.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skill Moves</td>
<td>3.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>3.0</td>
<td>3.0</td>
<td>3.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>...</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Work Rate</td>
<td>High/ Medium</td>
<td>High/ High</td>
<td>High/ High</td>
<td>High/ High</td>
<td>High/ High</td>
<td>High/ Medium</td>
<td>Medium/ Medium</td>
<td>High/ High</td>
<td>Medium/ High</td>
<td>High/ Medium</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
<td>Medium/ Medium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Body Type</td>
<td>Unique</td>
<td>Unique</td>
<td>Stocky (170-185)</td>
<td>Unique</td>
<td>Normal (170-)</td>
<td>Normal (170-185)</td>
<td>Normal (170-185)</td>
<td>Normal (170-185)</td>
<td>Stocky (185+)</td>
<td>Unique</td>
<td>...</td>
<td>Normal (185+)</td>
<td>Normal (185+)</td>
<td>Lean (185+)</td>
<td>Lean (185+)</td>
<td>Lean (185+)</td>
<td>Normal (185+)</td>
<td>Lean (185+)</td>
<td>Lean (185+)</td>
<td>Normal (185+)</td>
<td>Normal (185+)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Real Face</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>...</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Position</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>&lt;span class="pos pos9"&gt;RDM</td>
<td>&lt;span class="pos pos6"&gt;LCB</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>...</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Joined</td>
<td>Jul 1, 2018</td>
<td>Jan 30, 2020</td>
<td>Sep 14, 2020</td>
<td>Aug 30, 2015</td>
<td>Sep 1, 2020</td>
<td>Jul 1, 2015</td>
<td>Jul 1, 2021</td>
<td>Jul 22, 2021</td>
<td>Feb 18, 2020</td>
<td>Aug 7, 2019</td>
<td>...</td>
<td>Jun 14, 2020</td>
<td>Feb 15, 2019</td>
<td>Jul 1, 2020</td>
<td>Jul 1, 2019</td>
<td>Feb 7, 2022</td>
<td>Apr 11, 2022</td>
<td>Jan 1, 2022</td>
<td>Jun 6, 2021</td>
<td>Jan 1, 2020</td>
<td>Jan 8, 2020</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Loaned From</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Contract Valid Until</td>
<td>2026</td>
<td>2026</td>
<td>2024</td>
<td>2025</td>
<td>2026</td>
<td>2025</td>
<td>2026</td>
<td>2024</td>
<td>2024</td>
<td>2027</td>
<td>...</td>
<td>2022</td>
<td>2022</td>
<td>2022</td>
<td>2022</td>
<td>2023</td>
<td>2027</td>
<td>2026</td>
<td>2023</td>
<td>2021</td>
<td>2021</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Height</td>
<td>189cm</td>
<td>179cm</td>
<td>172cm</td>
<td>181cm</td>
<td>172cm</td>
<td>177cm</td>
<td>180cm</td>
<td>183cm</td>
<td>186cm</td>
<td>182cm</td>
<td>...</td>
<td>188cm</td>
<td>186cm</td>
<td>190cm</td>
<td>195cm</td>
<td>186cm</td>
<td>190cm</td>
<td>195cm</td>
<td>190cm</td>
<td>187cm</td>
<td>186cm</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Weight</td>
<td>82kg</td>
<td>69kg</td>
<td>69kg</td>
<td>70kg</td>
<td>68kg</td>
<td>75kg</td>
<td>78kg</td>
<td>80kg</td>
<td>86kg</td>
<td>74kg</td>
<td>...</td>
<td>81kg</td>
<td>78kg</td>
<td>70kg</td>
<td>80kg</td>
<td>78kg</td>
<td>78kg</td>
<td>84kg</td>
<td>82kg</td>
<td>79kg</td>
<td>78kg</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Release Clause</td>
<td>€157M</td>
<td>€155M</td>
<td>€97.7M</td>
<td>€198.9M</td>
<td>€154.4M</td>
<td>€182M</td>
<td>€113.8M</td>
<td>€48.5M</td>
<td>€51.9M</td>
<td>€152.6M</td>
<td>...</td>
<td>€218K</td>
<td>€47K</td>
<td>€356K</td>
<td>€215K</td>
<td>€488K</td>
<td>€218K</td>
<td>€188K</td>
<td>€142K</td>
<td>€214K</td>
<td>€131K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kit Number</td>
<td>8.0</td>
<td>8.0</td>
<td>19.0</td>
<td>17.0</td>
<td>23.0</td>
<td>6.0</td>
<td>4.0</td>
<td>15.0</td>
<td>23.0</td>
<td>7.0</td>
<td>...</td>
<td>33.0</td>
<td>1.0</td>
<td>99.0</td>
<td>27.0</td>
<td>43.0</td>
<td>35.0</td>
<td>21.0</td>
<td>12.0</td>
<td>40.0</td>
<td>30.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Best Overall Rating</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>29 rows × 17660 columns</p>
</div>
</div>
</div>
<section id="columns-조사" class="level3">
<h3 class="anchored" data-anchor-id="columns-조사">columns 조사</h3>
<div id="1a1b99fa-cf9d-4cdf-902f-25da8153f66d" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>Index(['ID', 'Name', 'Age', 'Photo', 'Nationality', 'Flag', 'Overall',
       'Potential', 'Club', 'Club Logo', 'Value', 'Wage', 'Special',
       'Preferred Foot', 'International Reputation', 'Weak Foot',
       'Skill Moves', 'Work Rate', 'Body Type', 'Real Face', 'Position',
       'Joined', 'Loaned From', 'Contract Valid Until', 'Height', 'Weight',
       'Release Clause', 'Kit Number', 'Best Overall Rating'],
      dtype='object')</code></pre>
</div>
</div>
<div id="887eba4c-39f3-4f82-b3e2-4c5d4e8ec2bf" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df.Body Type</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>SyntaxError: invalid syntax (&lt;ipython-input-29-8965601661e6&gt;, line 1)</code></pre>
</div>
</div>
<p>띄어쓰기가 되어있어서 흠..</p>
</section>
<section id="각-column별로-자료형-조사" class="level3">
<h3 class="anchored" data-anchor-id="각-column별로-자료형-조사">각 column별로 자료형 조사</h3>
<div id="2861dbe2-d044-4be0-9c0b-2a307c4970ef" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'ID'</span>].dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="00dcb808-3598-4799-900c-b1d504c9492b" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> df.keys():</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df[key].dtype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="413d3326-6368-4cf0-a11d-75263f1f131c" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dtypes <span class="op">=</span> [df[key].dtype <span class="cf">for</span> key <span class="kw">in</span> df.keys()]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({<span class="st">'colname'</span>:df.keys(), <span class="st">'dtype'</span>:dtypes})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="결측치-조사" class="level3">
<h3 class="anchored" data-anchor-id="결측치-조사">결측치 조사</h3>
<div id="6f5dfdb4-441d-4b61-94e7-9a08facfa657" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>[df[key].isna().<span class="bu">sum</span>() <span class="cf">for</span> key <span class="kw">in</span> df.keys()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="de979e95-ad1c-4435-93ec-3fa6e345a719" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({<span class="st">'colname'</span>:df.keys(), </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">'dtype'</span>:[df[key].dtype <span class="cf">for</span> key <span class="kw">in</span> df.keys()], </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'na'</span>:[df[key].isna().<span class="bu">sum</span>() <span class="cf">for</span> key <span class="kw">in</span> df.keys()]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">colname</th>
<th data-quarto-table-cell-role="th">dtype</th>
<th data-quarto-table-cell-role="th">na</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ID</td>
<td>int64</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Name</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Age</td>
<td>int64</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Photo</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Nationality</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Flag</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Overall</td>
<td>int64</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Potential</td>
<td>int64</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Club</td>
<td>object</td>
<td>211</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Club Logo</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Value</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Wage</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Special</td>
<td>int64</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Preferred Foot</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>International Reputation</td>
<td>float64</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Weak Foot</td>
<td>float64</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Skill Moves</td>
<td>float64</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Work Rate</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Body Type</td>
<td>object</td>
<td>38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Real Face</td>
<td>object</td>
<td>38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Position</td>
<td>object</td>
<td>35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Joined</td>
<td>object</td>
<td>1098</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Loaned From</td>
<td>object</td>
<td>16966</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Contract Valid Until</td>
<td>object</td>
<td>361</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Height</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Weight</td>
<td>object</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Release Clause</td>
<td>object</td>
<td>1151</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Kit Number</td>
<td>float64</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Best Overall Rating</td>
<td>object</td>
<td>17639</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ol start="17" type="A">
<li>열의선택: 결측치가 10000개 이상인 열을 보고싶다면?</li>
</ol>
<div id="8a7a7c3d-7343-423a-b367-5575beeee480" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df.loc[:,[df[key].isna().<span class="bu">sum</span>()<span class="op">&gt;</span><span class="dv">10000</span> <span class="cf">for</span> key <span class="kw">in</span> df.keys()]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>17660 rows × 2 columns</p>
</div>
</div>
</div>
</section>
<section id="info" class="level3">
<h3 class="anchored" data-anchor-id="info"><code>.info()</code></h3>
<div id="d96377df-1e2e-4ad7-afae-585b9070d6a2" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 17660 entries, 0 to 17659
Data columns (total 29 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   ID                        17660 non-null  int64  
 1   Name                      17660 non-null  object 
 2   Age                       17660 non-null  int64  
 3   Photo                     17660 non-null  object 
 4   Nationality               17660 non-null  object 
 5   Flag                      17660 non-null  object 
 6   Overall                   17660 non-null  int64  
 7   Potential                 17660 non-null  int64  
 8   Club                      17449 non-null  object 
 9   Club Logo                 17660 non-null  object 
 10  Value                     17660 non-null  object 
 11  Wage                      17660 non-null  object 
 12  Special                   17660 non-null  int64  
 13  Preferred Foot            17660 non-null  object 
 14  International Reputation  17660 non-null  float64
 15  Weak Foot                 17660 non-null  float64
 16  Skill Moves               17660 non-null  float64
 17  Work Rate                 17660 non-null  object 
 18  Body Type                 17622 non-null  object 
 19  Real Face                 17622 non-null  object 
 20  Position                  17625 non-null  object 
 21  Joined                    16562 non-null  object 
 22  Loaned From               694 non-null    object 
 23  Contract Valid Until      17299 non-null  object 
 24  Height                    17660 non-null  object 
 25  Weight                    17660 non-null  object 
 26  Release Clause            16509 non-null  object 
 27  Kit Number                17625 non-null  float64
 28  Best Overall Rating       21 non-null     object 
dtypes: float64(4), int64(5), object(20)
memory usage: 3.9+ MB</code></pre>
</div>
</div>
<p>### <code>.describe()</code></p>
<p>숫자들이 저장된 column에 대하여 기본통계량 조사</p>
<div id="3e3e8850-7f76-441b-94fc-a791aa53e1c4" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Special</th>
<th data-quarto-table-cell-role="th">International Reputation</th>
<th data-quarto-table-cell-role="th">Weak Foot</th>
<th data-quarto-table-cell-role="th">Skill Moves</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>17660.000000</td>
<td>17660.000000</td>
<td>17660.000000</td>
<td>17660.000000</td>
<td>17660.000000</td>
<td>17660.000000</td>
<td>17660.000000</td>
<td>17660.000000</td>
<td>17625.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>246319.424462</td>
<td>23.127746</td>
<td>63.369592</td>
<td>70.981200</td>
<td>1537.915855</td>
<td>1.106285</td>
<td>2.900340</td>
<td>2.297169</td>
<td>25.037957</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>31487.892861</td>
<td>4.639821</td>
<td>8.036268</td>
<td>6.529836</td>
<td>285.893809</td>
<td>0.407021</td>
<td>0.663523</td>
<td>0.754264</td>
<td>19.154116</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>16.000000</td>
<td>15.000000</td>
<td>43.000000</td>
<td>42.000000</td>
<td>749.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>240732.500000</td>
<td>20.000000</td>
<td>58.000000</td>
<td>67.000000</td>
<td>1387.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>2.000000</td>
<td>11.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>257041.000000</td>
<td>22.000000</td>
<td>63.000000</td>
<td>71.000000</td>
<td>1548.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>2.000000</td>
<td>22.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>263027.500000</td>
<td>26.000000</td>
<td>69.000000</td>
<td>75.000000</td>
<td>1727.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>32.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>271340.000000</td>
<td>54.000000</td>
<td>91.000000</td>
<td>95.000000</td>
<td>2312.000000</td>
<td>5.000000</td>
<td>5.000000</td>
<td>5.000000</td>
<td>99.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> pandas_profiling.ProfileReport()를 이용한 전체적인 조사</p>
<div id="4f294022-5311-4f03-b396-b1037ba81893" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pandas_profiling.ProfileReport(df).to_file(<span class="st">'fifa2023_reprot.html'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"de18a463619b4ddf91bf77d6c2f7b2fe","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/koinup4/anaconda3/envs/py37/lib/python3.7/site-packages/pandas_profiling/model/correlations.py:73: UserWarning: There was an attempt to calculate the auto correlation, but this failed.
To hide this warning, disable the calculation
(using `df.profile_report(correlations={"auto": {"calculate": False}})`
If this is problematic for your use case, please report this as an issue:
https://github.com/ydataai/pandas-profiling/issues
(include the error message: 'No data; `observed` has size 0.')</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cc521eb6ad4b4e83859a3de6bef0c0ed","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"35cf8c2e6558458d834d3f67b898ff75","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3bfa971e85bc4ea68c6fdc896e678aaa","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="특정열을-중심으로-정렬하여-보기" class="level3">
<h3 class="anchored" data-anchor-id="특정열을-중심으로-정렬하여-보기">특정열을 중심으로 정렬하여 보기</h3>
<div id="7c2fb55e-7741-41e7-a6cd-999519ba64ab" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">'Overall'</span>, ascending<span class="op">=</span><span class="va">False</span>) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ascending=False  # 내림차순</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Real Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">41</td>
<td>188545</td>
<td>R. Lewandowski</td>
<td>33</td>
<td>https://cdn.sofifa.net/players/188/545/23_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>91</td>
<td>91</td>
<td>FC Barcelona</td>
<td>https://cdn.sofifa.net/teams/241/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos25"&gt;ST</td>
<td>Jul 18, 2022</td>
<td>NaN</td>
<td>2025</td>
<td>185cm</td>
<td>81kg</td>
<td>€172.2M</td>
<td>9.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">124</td>
<td>165153</td>
<td>K. Benzema</td>
<td>34</td>
<td>https://cdn.sofifa.net/players/165/153/23_60.png</td>
<td>France</td>
<td>https://cdn.sofifa.net/flags/fr.png</td>
<td>91</td>
<td>91</td>
<td>Real Madrid CF</td>
<td>https://cdn.sofifa.net/teams/243/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos21"&gt;CF</td>
<td>Jul 9, 2009</td>
<td>NaN</td>
<td>2023</td>
<td>185cm</td>
<td>81kg</td>
<td>€131.2M</td>
<td>9.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>NaN</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>€198.9M</td>
<td>17.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56</td>
<td>158023</td>
<td>L. Messi</td>
<td>35</td>
<td>https://cdn.sofifa.net/players/158/023/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>91</td>
<td>91</td>
<td>Paris Saint-Germain</td>
<td>https://cdn.sofifa.net/teams/73/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos23"&gt;RW</td>
<td>Aug 10, 2021</td>
<td>NaN</td>
<td>2023</td>
<td>169cm</td>
<td>67kg</td>
<td>€99.9M</td>
<td>30.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>231747</td>
<td>K. Mbappé</td>
<td>23</td>
<td>https://cdn.sofifa.net/players/231/747/23_60.png</td>
<td>France</td>
<td>https://cdn.sofifa.net/flags/fr.png</td>
<td>91</td>
<td>95</td>
<td>Paris Saint-Germain</td>
<td>https://cdn.sofifa.net/teams/73/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos25"&gt;ST</td>
<td>Jul 1, 2018</td>
<td>NaN</td>
<td>2025</td>
<td>182cm</td>
<td>73kg</td>
<td>€366.7M</td>
<td>7.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15513</td>
<td>266751</td>
<td>22&nbsp;Jung Ho Yeon</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/266/751/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>45</td>
<td>53</td>
<td>GwangJu FC</td>
<td>https://cdn.sofifa.net/teams/112258/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 20, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>180cm</td>
<td>73kg</td>
<td>€145K</td>
<td>23.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16215</td>
<td>268279</td>
<td>22&nbsp;J. Looschen</td>
<td>24</td>
<td>https://cdn.sofifa.net/players/268/279/22_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>44</td>
<td>47</td>
<td>SV Meppen</td>
<td>https://cdn.sofifa.net/teams/110597/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Mar 19, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>178cm</td>
<td>78kg</td>
<td>€92K</td>
<td>42.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16042</td>
<td>255283</td>
<td>20&nbsp;Kim Yeong Geun</td>
<td>22</td>
<td>https://cdn.sofifa.net/players/255/283/20_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>44</td>
<td>49</td>
<td>Gyeongnam FC</td>
<td>https://cdn.sofifa.net/teams/111588/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 9, 2020</td>
<td>NaN</td>
<td>2020</td>
<td>174cm</td>
<td>71kg</td>
<td>€53K</td>
<td>43.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14634</td>
<td>269038</td>
<td>22&nbsp;Zhang Wenxuan</td>
<td>16</td>
<td>https://cdn.sofifa.net/players/269/038/22_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>44</td>
<td>59</td>
<td>Guangzhou FC</td>
<td>https://cdn.sofifa.net/teams/111839/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>May 1, 2022</td>
<td>NaN</td>
<td>2022</td>
<td>175cm</td>
<td>70kg</td>
<td>€239K</td>
<td>29.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17618</td>
<td>168933</td>
<td>07&nbsp;I. Paskov</td>
<td>33</td>
<td>https://cdn.sofifa.net/players/168/933/07_60.png</td>
<td>Bulgaria</td>
<td>https://cdn.sofifa.net/flags/bg.png</td>
<td>43</td>
<td>42</td>
<td>NaN</td>
<td>https://cdn.sofifa.net/flags/bg.png</td>
<td>...</td>
<td>NaN</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>184cm</td>
<td>79kg</td>
<td>NaN</td>
<td>24.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
<div id="2ec0de97-d8b7-4c68-bf57-7026f0c39c98" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">'Overall'</span>, ascending<span class="op">=</span><span class="va">False</span>,ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df.sort_values(by='Overall', ascending=False).reset_index() 와 같음</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 맨 왼쪽 인덱스 순서 정렬</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Real Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>188545</td>
<td>R. Lewandowski</td>
<td>33</td>
<td>https://cdn.sofifa.net/players/188/545/23_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>91</td>
<td>91</td>
<td>FC Barcelona</td>
<td>https://cdn.sofifa.net/teams/241/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos25"&gt;ST</td>
<td>Jul 18, 2022</td>
<td>NaN</td>
<td>2025</td>
<td>185cm</td>
<td>81kg</td>
<td>€172.2M</td>
<td>9.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>165153</td>
<td>K. Benzema</td>
<td>34</td>
<td>https://cdn.sofifa.net/players/165/153/23_60.png</td>
<td>France</td>
<td>https://cdn.sofifa.net/flags/fr.png</td>
<td>91</td>
<td>91</td>
<td>Real Madrid CF</td>
<td>https://cdn.sofifa.net/teams/243/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos21"&gt;CF</td>
<td>Jul 9, 2009</td>
<td>NaN</td>
<td>2023</td>
<td>185cm</td>
<td>81kg</td>
<td>€131.2M</td>
<td>9.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>NaN</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>€198.9M</td>
<td>17.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>158023</td>
<td>L. Messi</td>
<td>35</td>
<td>https://cdn.sofifa.net/players/158/023/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>91</td>
<td>91</td>
<td>Paris Saint-Germain</td>
<td>https://cdn.sofifa.net/teams/73/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos23"&gt;RW</td>
<td>Aug 10, 2021</td>
<td>NaN</td>
<td>2023</td>
<td>169cm</td>
<td>67kg</td>
<td>€99.9M</td>
<td>30.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>231747</td>
<td>K. Mbappé</td>
<td>23</td>
<td>https://cdn.sofifa.net/players/231/747/23_60.png</td>
<td>France</td>
<td>https://cdn.sofifa.net/flags/fr.png</td>
<td>91</td>
<td>95</td>
<td>Paris Saint-Germain</td>
<td>https://cdn.sofifa.net/teams/73/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos25"&gt;ST</td>
<td>Jul 1, 2018</td>
<td>NaN</td>
<td>2025</td>
<td>182cm</td>
<td>73kg</td>
<td>€366.7M</td>
<td>7.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>266751</td>
<td>22&nbsp;Jung Ho Yeon</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/266/751/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>45</td>
<td>53</td>
<td>GwangJu FC</td>
<td>https://cdn.sofifa.net/teams/112258/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 20, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>180cm</td>
<td>73kg</td>
<td>€145K</td>
<td>23.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>268279</td>
<td>22&nbsp;J. Looschen</td>
<td>24</td>
<td>https://cdn.sofifa.net/players/268/279/22_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>44</td>
<td>47</td>
<td>SV Meppen</td>
<td>https://cdn.sofifa.net/teams/110597/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Mar 19, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>178cm</td>
<td>78kg</td>
<td>€92K</td>
<td>42.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>255283</td>
<td>20&nbsp;Kim Yeong Geun</td>
<td>22</td>
<td>https://cdn.sofifa.net/players/255/283/20_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>44</td>
<td>49</td>
<td>Gyeongnam FC</td>
<td>https://cdn.sofifa.net/teams/111588/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 9, 2020</td>
<td>NaN</td>
<td>2020</td>
<td>174cm</td>
<td>71kg</td>
<td>€53K</td>
<td>43.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>269038</td>
<td>22&nbsp;Zhang Wenxuan</td>
<td>16</td>
<td>https://cdn.sofifa.net/players/269/038/22_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>44</td>
<td>59</td>
<td>Guangzhou FC</td>
<td>https://cdn.sofifa.net/teams/111839/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>May 1, 2022</td>
<td>NaN</td>
<td>2022</td>
<td>175cm</td>
<td>70kg</td>
<td>€239K</td>
<td>29.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>168933</td>
<td>07&nbsp;I. Paskov</td>
<td>33</td>
<td>https://cdn.sofifa.net/players/168/933/07_60.png</td>
<td>Bulgaria</td>
<td>https://cdn.sofifa.net/flags/bg.png</td>
<td>43</td>
<td>42</td>
<td>NaN</td>
<td>https://cdn.sofifa.net/flags/bg.png</td>
<td>...</td>
<td>NaN</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>184cm</td>
<td>79kg</td>
<td>NaN</td>
<td>24.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
</section>
<section id="특정열을-중심으로-그룹화하여-보기star-groupby" class="level3">
<h3 class="anchored" data-anchor-id="특정열을-중심으로-그룹화하여-보기star-groupby">특정열을 중심으로 그룹화하여 보기(<span class="math inline">\(\star\)</span>): groupby</h3>
<div id="afc5b246-8a01-4d66-abe6-2fbbb158c3c1" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df.query(<span class="st">'Nationality == "Germany"'</span>)[<span class="st">'Overall'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>63.50481695568401</code></pre>
</div>
</div>
<div id="1214bc7d-08af-479e-aef9-72562311026f" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df.Nationality.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>array(['Germany', 'Portugal', 'Argentina', 'Belgium', 'Italy', 'Austria',
       'Brazil', 'Croatia', 'Serbia', 'Spain', 'Netherlands', 'France',
       'Colombia', 'England', 'Uruguay', 'Morocco', 'Egypt', 'Algeria',
       'Ukraine', 'United States', "Côte d'Ivoire", 'Poland', 'Chile',
       'Senegal', 'Central African Republic', 'Denmark', 'Nigeria',
       'Mexico', 'Turkey', 'Canada', 'Wales', 'Scotland', 'Romania',
       'Czech Republic', 'Ghana', 'Korea Republic',
       'Bosnia and Herzegovina', 'Mali', 'Slovakia', 'Armenia', 'Norway',
       'Switzerland', 'Cameroon', 'Peru', 'Jamaica', 'Zambia', 'Guinea',
       'Sweden', 'North Macedonia', 'Russia', 'Tunisia', 'Malta',
       'Angola', 'Republic of Ireland', 'Ecuador', 'Benin', 'Paraguay',
       'Montenegro', 'Australia', 'Comoros', 'Gabon', 'Iceland',
       'Slovenia', 'Japan', 'Israel', 'China PR', 'Venezuela', 'Liberia',
       'Greece', 'Bulgaria', 'Honduras', 'Saudi Arabia', 'Curacao',
       'Northern Ireland', 'Guinea Bissau', 'Kosovo', 'Hungary',
       'Finland', 'Costa Rica', 'Albania', 'Congo DR', 'Iran',
       'Mozambique', 'Suriname', 'Cape Verde Islands', 'Bolivia',
       'Madagascar', 'New Zealand', 'Burkina Faso', 'Dominican Republic',
       'Kazakhstan', 'Syria', 'Luxembourg', 'Kenya', 'Zimbabwe', 'Haiti',
       'Uzbekistan', 'South Africa', 'Cyprus', 'Qatar',
       'Equatorial Guinea', 'Libya', 'Thailand', 'Togo',
       'Trinidad and Tobago', 'Liechtenstein', 'Gambia', 'Georgia',
       'Philippines', 'Burundi', 'United Arab Emirates', 'Grenada',
       'Iraq', 'Panama', 'Malaysia', 'Moldova', 'Congo', 'India',
       'Jordan', 'Kuwait', 'Antigua and Barbuda', 'Cuba', 'Vietnam',
       'Korea DPR', 'Uganda', 'Lithuania', 'Estonia', 'Montserrat',
       'Sierra Leone', 'Afghanistan', 'New Caledonia', 'Belarus', 'Laos',
       'Saint Lucia', 'Bhutan', 'Guyana', 'Mauritania', 'Faroe Islands',
       'Namibia', 'Niger', 'Palestine', 'Sudan', 'Azerbaijan',
       'Hong Kong', 'Gibraltar', 'Tanzania', 'Latvia', 'Chinese Taipei',
       'Singapore', 'Lebanon', 'El Salvador', 'Indonesia', 'Guatemala',
       'Papua New Guinea', 'Puerto Rico', 'Malawi', 'South Sudan',
       'Ethiopia', 'San Marino', 'Andorra', 'Saint Kitts and Nevis'],
      dtype=object)</code></pre>
</div>
</div>
<div id="46781f0e-9d0c-49f7-bdfa-9a0dc5fbae76" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(df.Nationality.unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>161</code></pre>
</div>
</div>
<div id="12a4c99b-e10e-47a4-ba7c-404cf9174154" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">'Nationality'</span>)[[<span class="st">'Overall'</span>]].agg({np.mean,<span class="bu">len</span>}).sort_values((<span class="st">'Overall'</span>, <span class="st">'mean'</span>),ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Overall</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">len</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Philippines</td>
<td>74.000000</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Namibia</td>
<td>72.000000</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Mozambique</td>
<td>72.000000</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kuwait</td>
<td>71.000000</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Brazil</td>
<td>70.556586</td>
<td>539</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">San Marino</td>
<td>53.000000</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">China PR</td>
<td>52.230769</td>
<td>325</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">South Sudan</td>
<td>52.000000</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">India</td>
<td>51.994681</td>
<td>188</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Saint Kitts and Nevis</td>
<td>51.000000</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>161 rows × 2 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="데이터-정리하기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-정리하기">데이터 정리하기</h2>
<section id="칼럼이름-변경" class="level3">
<h3 class="anchored" data-anchor-id="칼럼이름-변경">칼럼이름 변경</h3>
<div id="5d64f27b-5579-44aa-94ec-bf238cdc91f2" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>Index(['ID', 'Name', 'Age', 'Photo', 'Nationality', 'Flag', 'Overall',
       'Potential', 'Club', 'Club Logo', 'Value', 'Wage', 'Special',
       'Preferred Foot', 'International Reputation', 'Weak Foot',
       'Skill Moves', 'Work Rate', 'Body Type', 'Real Face', 'Position',
       'Joined', 'Loaned From', 'Contract Valid Until', 'Height', 'Weight',
       'Release Clause', 'Kit Number', 'Best Overall Rating'],
      dtype='object')</code></pre>
</div>
</div>
<div id="fe795094-7364-41e5-9ccf-5a9b15632de7" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">' '</span>,<span class="st">'_'</span>), df.columns))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>['ID',
 'Name',
 'Age',
 'Photo',
 'Nationality',
 'Flag',
 'Overall',
 'Potential',
 'Club',
 'Club_Logo',
 'Value',
 'Wage',
 'Special',
 'Preferred_Foot',
 'International_Reputation',
 'Weak_Foot',
 'Skill_Moves',
 'Work_Rate',
 'Body_Type',
 'Real_Face',
 'Position',
 'Joined',
 'Loaned_From',
 'Contract_Valid_Until',
 'Height',
 'Weight',
 'Release_Clause',
 'Kit_Number',
 'Best_Overall_Rating']</code></pre>
</div>
</div>
<div id="6919f787-7ba9-4972-8ea1-f4f666fa30d0" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>df.set_axis(<span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">' '</span>,<span class="st">'_'</span>), df.columns)), axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club_Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Real_Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned_From</th>
<th data-quarto-table-cell-role="th">Contract_Valid_Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release_Clause</th>
<th data-quarto-table-cell-role="th">Kit_Number</th>
<th data-quarto-table-cell-role="th">Best_Overall_Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>209658</td>
<td>L. Goretzka</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>87</td>
<td>88</td>
<td>FC Bayern München</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Jul 1, 2018</td>
<td>NaN</td>
<td>2026</td>
<td>189cm</td>
<td>82kg</td>
<td>€157M</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>212198</td>
<td>Bruno Fernandes</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>Portugal</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>86</td>
<td>87</td>
<td>Manchester United</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>Jan 30, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>179cm</td>
<td>69kg</td>
<td>€155M</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>224334</td>
<td>M. Acuña</td>
<td>30</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>85</td>
<td>85</td>
<td>Sevilla FC</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>Sep 14, 2020</td>
<td>NaN</td>
<td>2024</td>
<td>172cm</td>
<td>69kg</td>
<td>€97.7M</td>
<td>19.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>NaN</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>€198.9M</td>
<td>17.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Sep 1, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>172cm</td>
<td>68kg</td>
<td>€154.4M</td>
<td>23.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>269526</td>
<td>Deng Xiongtao</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>48</td>
<td>61</td>
<td>Meizhou Hakka</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Apr 11, 2022</td>
<td>NaN</td>
<td>2027</td>
<td>190cm</td>
<td>78kg</td>
<td>€218K</td>
<td>35.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>267946</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>17</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>48</td>
<td>64</td>
<td>Jeju United FC</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>195cm</td>
<td>84kg</td>
<td>€188K</td>
<td>21.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>270567</td>
<td>A. Demir</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>Turkey</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>51</td>
<td>56</td>
<td>Ümraniyespor</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jun 6, 2021</td>
<td>NaN</td>
<td>2023</td>
<td>190cm</td>
<td>82kg</td>
<td>€142K</td>
<td>12.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>256624</td>
<td>21&nbsp;S. Czajor</td>
<td>18</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>50</td>
<td>65</td>
<td>Fleetwood Town</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>187cm</td>
<td>79kg</td>
<td>€214K</td>
<td>40.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>256376</td>
<td>21&nbsp;F. Jakobsson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
<td>Sweden</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>50</td>
<td>61</td>
<td>IFK Norrköping</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 8, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>186cm</td>
<td>78kg</td>
<td>€131K</td>
<td>30.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
<div id="d75ca46d-fb25-4f3e-b176-4711a86b907d" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df.set_axis(pd.Index(<span class="bu">map</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">' '</span>,<span class="st">'_'</span>), df.columns)), axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club_Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Real_Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned_From</th>
<th data-quarto-table-cell-role="th">Contract_Valid_Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release_Clause</th>
<th data-quarto-table-cell-role="th">Kit_Number</th>
<th data-quarto-table-cell-role="th">Best_Overall_Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>209658</td>
<td>L. Goretzka</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>87</td>
<td>88</td>
<td>FC Bayern München</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Jul 1, 2018</td>
<td>NaN</td>
<td>2026</td>
<td>189cm</td>
<td>82kg</td>
<td>€157M</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>212198</td>
<td>Bruno Fernandes</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>Portugal</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>86</td>
<td>87</td>
<td>Manchester United</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>Jan 30, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>179cm</td>
<td>69kg</td>
<td>€155M</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>224334</td>
<td>M. Acuña</td>
<td>30</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>85</td>
<td>85</td>
<td>Sevilla FC</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>Sep 14, 2020</td>
<td>NaN</td>
<td>2024</td>
<td>172cm</td>
<td>69kg</td>
<td>€97.7M</td>
<td>19.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>NaN</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>€198.9M</td>
<td>17.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Sep 1, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>172cm</td>
<td>68kg</td>
<td>€154.4M</td>
<td>23.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>269526</td>
<td>Deng Xiongtao</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>48</td>
<td>61</td>
<td>Meizhou Hakka</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Apr 11, 2022</td>
<td>NaN</td>
<td>2027</td>
<td>190cm</td>
<td>78kg</td>
<td>€218K</td>
<td>35.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>267946</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>17</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>48</td>
<td>64</td>
<td>Jeju United FC</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>195cm</td>
<td>84kg</td>
<td>€188K</td>
<td>21.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>270567</td>
<td>A. Demir</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>Turkey</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>51</td>
<td>56</td>
<td>Ümraniyespor</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jun 6, 2021</td>
<td>NaN</td>
<td>2023</td>
<td>190cm</td>
<td>82kg</td>
<td>€142K</td>
<td>12.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>256624</td>
<td>21&nbsp;S. Czajor</td>
<td>18</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>50</td>
<td>65</td>
<td>Fleetwood Town</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>187cm</td>
<td>79kg</td>
<td>€214K</td>
<td>40.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>256376</td>
<td>21&nbsp;F. Jakobsson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
<td>Sweden</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>50</td>
<td>61</td>
<td>IFK Norrköping</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 8, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>186cm</td>
<td>78kg</td>
<td>€131K</td>
<td>30.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
<ul>
<li>index 로 쓰는게 좀 더 명확함</li>
</ul>
</section>
<section id="결측치-제거" class="level3">
<h3 class="anchored" data-anchor-id="결측치-제거">결측치 제거</h3>
<div id="9e446232-b9fd-48c8-97e9-0039064cb396" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 17660 entries, 0 to 17659
Data columns (total 29 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   ID                        17660 non-null  int64  
 1   Name                      17660 non-null  object 
 2   Age                       17660 non-null  int64  
 3   Photo                     17660 non-null  object 
 4   Nationality               17660 non-null  object 
 5   Flag                      17660 non-null  object 
 6   Overall                   17660 non-null  int64  
 7   Potential                 17660 non-null  int64  
 8   Club                      17449 non-null  object 
 9   Club Logo                 17660 non-null  object 
 10  Value                     17660 non-null  object 
 11  Wage                      17660 non-null  object 
 12  Special                   17660 non-null  int64  
 13  Preferred Foot            17660 non-null  object 
 14  International Reputation  17660 non-null  float64
 15  Weak Foot                 17660 non-null  float64
 16  Skill Moves               17660 non-null  float64
 17  Work Rate                 17660 non-null  object 
 18  Body Type                 17622 non-null  object 
 19  Real Face                 17622 non-null  object 
 20  Position                  17625 non-null  object 
 21  Joined                    16562 non-null  object 
 22  Loaned From               694 non-null    object 
 23  Contract Valid Until      17299 non-null  object 
 24  Height                    17660 non-null  object 
 25  Weight                    17660 non-null  object 
 26  Release Clause            16509 non-null  object 
 27  Kit Number                17625 non-null  float64
 28  Best Overall Rating       21 non-null     object 
dtypes: float64(4), int64(5), object(20)
memory usage: 3.9+ MB</code></pre>
</div>
</div>
<div id="ff3c67dc-d7b7-4099-8f43-5a450cbe73cf" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">'Loaned From'</span>, <span class="st">'Best Overall Rating'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Work Rate</th>
<th data-quarto-table-cell-role="th">Body Type</th>
<th data-quarto-table-cell-role="th">Real Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>209658</td>
<td>L. Goretzka</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>87</td>
<td>88</td>
<td>FC Bayern München</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>...</td>
<td>High/ Medium</td>
<td>Unique</td>
<td>Yes</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Jul 1, 2018</td>
<td>2026</td>
<td>189cm</td>
<td>82kg</td>
<td>€157M</td>
<td>8.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>212198</td>
<td>Bruno Fernandes</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>Portugal</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>86</td>
<td>87</td>
<td>Manchester United</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>...</td>
<td>High/ High</td>
<td>Unique</td>
<td>Yes</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>Jan 30, 2020</td>
<td>2026</td>
<td>179cm</td>
<td>69kg</td>
<td>€155M</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>224334</td>
<td>M. Acuña</td>
<td>30</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>85</td>
<td>85</td>
<td>Sevilla FC</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>...</td>
<td>High/ High</td>
<td>Stocky (170-185)</td>
<td>No</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>Sep 14, 2020</td>
<td>2024</td>
<td>172cm</td>
<td>69kg</td>
<td>€97.7M</td>
<td>19.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>High/ High</td>
<td>Unique</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>€198.9M</td>
<td>17.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>High/ High</td>
<td>Normal (170-)</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Sep 1, 2020</td>
<td>2026</td>
<td>172cm</td>
<td>68kg</td>
<td>€154.4M</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>269526</td>
<td>Deng Xiongtao</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>48</td>
<td>61</td>
<td>Meizhou Hakka</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Normal (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Apr 11, 2022</td>
<td>2027</td>
<td>190cm</td>
<td>78kg</td>
<td>€218K</td>
<td>35.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>267946</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>17</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>48</td>
<td>64</td>
<td>Jeju United FC</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Lean (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2022</td>
<td>2026</td>
<td>195cm</td>
<td>84kg</td>
<td>€188K</td>
<td>21.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>270567</td>
<td>A. Demir</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>Turkey</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>51</td>
<td>56</td>
<td>Ümraniyespor</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Lean (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jun 6, 2021</td>
<td>2023</td>
<td>190cm</td>
<td>82kg</td>
<td>€142K</td>
<td>12.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>256624</td>
<td>21&nbsp;S. Czajor</td>
<td>18</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>50</td>
<td>65</td>
<td>Fleetwood Town</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Normal (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2020</td>
<td>2021</td>
<td>187cm</td>
<td>79kg</td>
<td>€214K</td>
<td>40.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>256376</td>
<td>21&nbsp;F. Jakobsson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
<td>Sweden</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>50</td>
<td>61</td>
<td>IFK Norrköping</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Normal (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 8, 2020</td>
<td>2021</td>
<td>186cm</td>
<td>78kg</td>
<td>€131K</td>
<td>30.0</td>
</tr>
</tbody>
</table>

<p>17660 rows × 27 columns</p>
</div>
</div>
</div>
<p><code>-</code> Height, Weight의 자료형을 float형으로 수정하기</p>
<div id="ffc0bd01-2a92-40cc-b3e6-34822ebfefba" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'Height'</span>, <span class="st">'Weight'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>189cm</td>
<td>82kg</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>179cm</td>
<td>69kg</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>172cm</td>
<td>69kg</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>181cm</td>
<td>70kg</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>172cm</td>
<td>68kg</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>190cm</td>
<td>78kg</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>195cm</td>
<td>84kg</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>190cm</td>
<td>82kg</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>187cm</td>
<td>79kg</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>186cm</td>
<td>78kg</td>
</tr>
</tbody>
</table>

<p>17660 rows × 2 columns</p>
</div>
</div>
</div>
<p>cm, kg으로 되어있어서 object형인데 이걸 float형으로 바꾸자</p>
<div id="172805ff-630b-4499-8e25-0621331a3c99" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>df.assign(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    Height<span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">float</span>(x[:<span class="op">-</span><span class="dv">2</span>]), df.Height)),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    Weight<span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">float</span>(x[:<span class="op">-</span><span class="dv">2</span>]), df.Weight))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Real Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>209658</td>
<td>L. Goretzka</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>87</td>
<td>88</td>
<td>FC Bayern München</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Jul 1, 2018</td>
<td>NaN</td>
<td>2026</td>
<td>189.0</td>
<td>82.0</td>
<td>€157M</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>212198</td>
<td>Bruno Fernandes</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>Portugal</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>86</td>
<td>87</td>
<td>Manchester United</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>Jan 30, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>179.0</td>
<td>69.0</td>
<td>€155M</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>224334</td>
<td>M. Acuña</td>
<td>30</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>85</td>
<td>85</td>
<td>Sevilla FC</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>Sep 14, 2020</td>
<td>NaN</td>
<td>2024</td>
<td>172.0</td>
<td>69.0</td>
<td>€97.7M</td>
<td>19.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>NaN</td>
<td>2025</td>
<td>181.0</td>
<td>70.0</td>
<td>€198.9M</td>
<td>17.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Sep 1, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>172.0</td>
<td>68.0</td>
<td>€154.4M</td>
<td>23.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>269526</td>
<td>Deng Xiongtao</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>48</td>
<td>61</td>
<td>Meizhou Hakka</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Apr 11, 2022</td>
<td>NaN</td>
<td>2027</td>
<td>190.0</td>
<td>78.0</td>
<td>€218K</td>
<td>35.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>267946</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>17</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>48</td>
<td>64</td>
<td>Jeju United FC</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>195.0</td>
<td>84.0</td>
<td>€188K</td>
<td>21.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>270567</td>
<td>A. Demir</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>Turkey</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>51</td>
<td>56</td>
<td>Ümraniyespor</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jun 6, 2021</td>
<td>NaN</td>
<td>2023</td>
<td>190.0</td>
<td>82.0</td>
<td>€142K</td>
<td>12.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>256624</td>
<td>21&nbsp;S. Czajor</td>
<td>18</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>50</td>
<td>65</td>
<td>Fleetwood Town</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>187.0</td>
<td>79.0</td>
<td>€214K</td>
<td>40.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>256376</td>
<td>21&nbsp;F. Jakobsson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
<td>Sweden</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>50</td>
<td>61</td>
<td>IFK Norrköping</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 8, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>186.0</td>
<td>78.0</td>
<td>€131K</td>
<td>30.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
<p><code>-</code> Release Clause의 자료형을 float으로 수정하기</p>
<div id="7fe1c359-3e14-42b6-865e-7014b2115d5f" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Release Clause'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>0          €157M
1          €155M
2         €97.7M
3        €198.9M
4        €154.4M
          ...   
17655      €218K
17656      €188K
17657      €142K
17658      €214K
17659      €131K
Name: Release Clause, Length: 17660, dtype: object</code></pre>
</div>
</div>
<div id="03fa55ae-f50e-4032-8e86-091a0075358a" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>_f <span class="op">=</span> <span class="kw">lambda</span> x: <span class="bu">float</span>(x[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span><span class="dv">1000</span> <span class="cf">if</span> x[<span class="op">-</span><span class="dv">1</span>]<span class="op">==</span><span class="st">'K'</span> <span class="cf">else</span> <span class="bu">float</span>(x[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span><span class="dv">1000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e7f4d882-1076-4788-b9ad-8d601995a524" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>_f(<span class="st">'€157M'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>157000000.0</code></pre>
</div>
</div>
<div id="ae4afeb7-b9bf-44f7-aa1c-0de6182cad47" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>_f(<span class="st">'€131K'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>131000.0</code></pre>
</div>
</div>
<p>(시도1) - 실패</p>
<div id="2e0e9e7a-4f64-438f-bca6-99618089d1cb" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(<span class="bu">map</span>(_f, df[<span class="st">'Release Clause'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: 'float' object is not subscriptable</code></pre>
</div>
</div>
<div id="dcfd133a-1595-4acd-ae62-f18f15a8d121" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Release Clause'</span>].isna().<span class="bu">sum</span>()   <span class="co"># 이 column에는 1151개의 결측치가 존재</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>1151</code></pre>
</div>
</div>
<p>(nan에 대한 예비학습)</p>
<div id="0363117d-2a08-4789-b154-19cd38a5def1" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">'Release Clause'</span>].isna(), <span class="st">'Release Clause'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>18       NaN
34       NaN
38       NaN
49       NaN
50       NaN
        ... 
17378    NaN
17386    NaN
17535    NaN
17590    NaN
17618    NaN
Name: Release Clause, Length: 1151, dtype: object</code></pre>
</div>
</div>
<div id="c231abf9-5c3b-4989-a2ca-c5fd24cfeb91" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="dv">18</span>, <span class="st">'Release Clause'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>nan</code></pre>
</div>
</div>
<div id="aae66b5e-de07-4fba-8252-d3395fea63cc" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>pd.isna(df.loc[<span class="dv">18</span>, <span class="st">'Release Clause'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>True</code></pre>
</div>
</div>
<div id="cfe466e8-bfb8-41c2-bcda-eb340bcf35d6" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(df.loc[<span class="dv">18</span>, <span class="st">'Release Clause'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>float</code></pre>
</div>
</div>
<div id="f18b6038-62c4-4050-8e03-40297b104c53" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="dv">18</span>, <span class="st">'Release Clause'</span>][<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: 'float' object is not subscriptable</code></pre>
</div>
</div>
<ul>
<li>_f 함수에는 문자열이 들어가야하는데 nan이 들어가니까 에러가 뜸..</li>
</ul>
<p>(시도2) - 성공</p>
<div id="2dc461af-bb73-4f63-a4ab-aa7eed3c9dea" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">'Release Clause'</span>:<span class="st">'ReleaseClause'</span>})<span class="op">\</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>.assign(ReleaseClause <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: _f(x) <span class="cf">if</span> pd.isna(x)<span class="op">==</span><span class="va">False</span> <span class="cf">else</span> x , df[<span class="st">'Release Clause'</span>])))<span class="op">\</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>.rename(columns<span class="op">=</span>{<span class="st">'ReleaseClause'</span>:<span class="st">'Release Clause'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Real Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>209658</td>
<td>L. Goretzka</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>87</td>
<td>88</td>
<td>FC Bayern München</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Jul 1, 2018</td>
<td>NaN</td>
<td>2026</td>
<td>189cm</td>
<td>82kg</td>
<td>157000000.0</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>212198</td>
<td>Bruno Fernandes</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>Portugal</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>86</td>
<td>87</td>
<td>Manchester United</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>Jan 30, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>179cm</td>
<td>69kg</td>
<td>155000000.0</td>
<td>8.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>224334</td>
<td>M. Acuña</td>
<td>30</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>85</td>
<td>85</td>
<td>Sevilla FC</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>Sep 14, 2020</td>
<td>NaN</td>
<td>2024</td>
<td>172cm</td>
<td>69kg</td>
<td>97700000.0</td>
<td>19.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>NaN</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>198900000.0</td>
<td>17.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Sep 1, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>172cm</td>
<td>68kg</td>
<td>154400000.0</td>
<td>23.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>269526</td>
<td>Deng Xiongtao</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>48</td>
<td>61</td>
<td>Meizhou Hakka</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Apr 11, 2022</td>
<td>NaN</td>
<td>2027</td>
<td>190cm</td>
<td>78kg</td>
<td>218000.0</td>
<td>35.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>267946</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>17</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>48</td>
<td>64</td>
<td>Jeju United FC</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>195cm</td>
<td>84kg</td>
<td>188000.0</td>
<td>21.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>270567</td>
<td>A. Demir</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>Turkey</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>51</td>
<td>56</td>
<td>Ümraniyespor</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jun 6, 2021</td>
<td>NaN</td>
<td>2023</td>
<td>190cm</td>
<td>82kg</td>
<td>142000.0</td>
<td>12.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>256624</td>
<td>21&nbsp;S. Czajor</td>
<td>18</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>50</td>
<td>65</td>
<td>Fleetwood Town</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>187cm</td>
<td>79kg</td>
<td>214000.0</td>
<td>40.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>256376</td>
<td>21&nbsp;F. Jakobsson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
<td>Sweden</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>50</td>
<td>61</td>
<td>IFK Norrköping</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
<td>...</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 8, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>186cm</td>
<td>78kg</td>
<td>131000.0</td>
<td>30.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>17660 rows × 29 columns</p>
</div>
</div>
</div>
<div id="471689bb-192b-4c7e-85ec-206c78e6e6a8" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">'Release Clause'</span>:<span class="st">'ReleaseClause'</span>})<span class="op">\</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>.assign(ReleaseClause <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: _f(x) <span class="cf">if</span> pd.isna(x)<span class="op">==</span><span class="va">False</span> <span class="cf">else</span> x , df[<span class="st">'Release Clause'</span>])))<span class="op">\</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>.rename(columns<span class="op">=</span>{<span class="st">'ReleaseClause'</span>:<span class="st">'Release Clause'</span>}).info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 17660 entries, 0 to 17659
Data columns (total 29 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   ID                        17660 non-null  int64  
 1   Name                      17660 non-null  object 
 2   Age                       17660 non-null  int64  
 3   Photo                     17660 non-null  object 
 4   Nationality               17660 non-null  object 
 5   Flag                      17660 non-null  object 
 6   Overall                   17660 non-null  int64  
 7   Potential                 17660 non-null  int64  
 8   Club                      17449 non-null  object 
 9   Club Logo                 17660 non-null  object 
 10  Value                     17660 non-null  object 
 11  Wage                      17660 non-null  object 
 12  Special                   17660 non-null  int64  
 13  Preferred Foot            17660 non-null  object 
 14  International Reputation  17660 non-null  float64
 15  Weak Foot                 17660 non-null  float64
 16  Skill Moves               17660 non-null  float64
 17  Work Rate                 17660 non-null  object 
 18  Body Type                 17622 non-null  object 
 19  Real Face                 17622 non-null  object 
 20  Position                  17625 non-null  object 
 21  Joined                    16562 non-null  object 
 22  Loaned From               694 non-null    object 
 23  Contract Valid Until      17299 non-null  object 
 24  Height                    17660 non-null  object 
 25  Weight                    17660 non-null  object 
 26  Release Clause            16509 non-null  float64
 27  Kit Number                17625 non-null  float64
 28  Best Overall Rating       21 non-null     object 
dtypes: float64(5), int64(5), object(19)
memory usage: 3.9+ MB</code></pre>
</div>
</div>
<p>26번 컬럼이 float64로 바뀜!</p>
<p>(시도3) - 성공, 그냥 결측치를 제거하고 변경해도 무방</p>
<div id="8254500f-43a3-47a7-bff6-499fc45d1da9" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">'Loaned From'</span>, <span class="st">'Best Overall Rating'</span>]).dropna()</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">'Release Clause'</span>] <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: _f(x) <span class="cf">if</span> pd.isna(x)<span class="op">==</span><span class="va">False</span> <span class="cf">else</span> x , df2[<span class="st">'Release Clause'</span>]))</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Work Rate</th>
<th data-quarto-table-cell-role="th">Body Type</th>
<th data-quarto-table-cell-role="th">Real Face</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>209658</td>
<td>L. Goretzka</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>87</td>
<td>88</td>
<td>FC Bayern München</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>...</td>
<td>High/ Medium</td>
<td>Unique</td>
<td>Yes</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Jul 1, 2018</td>
<td>2026</td>
<td>189cm</td>
<td>82kg</td>
<td>157000000.0</td>
<td>8.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>212198</td>
<td>Bruno Fernandes</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>Portugal</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>86</td>
<td>87</td>
<td>Manchester United</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>...</td>
<td>High/ High</td>
<td>Unique</td>
<td>Yes</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>Jan 30, 2020</td>
<td>2026</td>
<td>179cm</td>
<td>69kg</td>
<td>155000000.0</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>224334</td>
<td>M. Acuña</td>
<td>30</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>85</td>
<td>85</td>
<td>Sevilla FC</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>...</td>
<td>High/ High</td>
<td>Stocky (170-185)</td>
<td>No</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>Sep 14, 2020</td>
<td>2024</td>
<td>172cm</td>
<td>69kg</td>
<td>97700000.0</td>
<td>19.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>High/ High</td>
<td>Unique</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>198900000.0</td>
<td>17.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>High/ High</td>
<td>Normal (170-)</td>
<td>Yes</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Sep 1, 2020</td>
<td>2026</td>
<td>172cm</td>
<td>68kg</td>
<td>154400000.0</td>
<td>23.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>269526</td>
<td>Deng Xiongtao</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>48</td>
<td>61</td>
<td>Meizhou Hakka</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Normal (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Apr 11, 2022</td>
<td>2027</td>
<td>190cm</td>
<td>78kg</td>
<td>218000.0</td>
<td>35.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>267946</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>17</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>48</td>
<td>64</td>
<td>Jeju United FC</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Lean (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2022</td>
<td>2026</td>
<td>195cm</td>
<td>84kg</td>
<td>188000.0</td>
<td>21.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>270567</td>
<td>A. Demir</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>Turkey</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>51</td>
<td>56</td>
<td>Ümraniyespor</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Lean (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jun 6, 2021</td>
<td>2023</td>
<td>190cm</td>
<td>82kg</td>
<td>142000.0</td>
<td>12.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>256624</td>
<td>21&nbsp;S. Czajor</td>
<td>18</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>50</td>
<td>65</td>
<td>Fleetwood Town</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Normal (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2020</td>
<td>2021</td>
<td>187cm</td>
<td>79kg</td>
<td>214000.0</td>
<td>40.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>256376</td>
<td>21&nbsp;F. Jakobsson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
<td>Sweden</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>50</td>
<td>61</td>
<td>IFK Norrköping</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
<td>...</td>
<td>Medium/ Medium</td>
<td>Normal (185+)</td>
<td>No</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 8, 2020</td>
<td>2021</td>
<td>186cm</td>
<td>78kg</td>
<td>131000.0</td>
<td>30.0</td>
</tr>
</tbody>
</table>

<p>16364 rows × 27 columns</p>
</div>
</div>
</div>
<div id="12b861cb-27ce-4ac7-afc1-ea7fe90fd3a7" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df2.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 16364 entries, 0 to 17659
Data columns (total 27 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   ID                        16364 non-null  int64  
 1   Name                      16364 non-null  object 
 2   Age                       16364 non-null  int64  
 3   Photo                     16364 non-null  object 
 4   Nationality               16364 non-null  object 
 5   Flag                      16364 non-null  object 
 6   Overall                   16364 non-null  int64  
 7   Potential                 16364 non-null  int64  
 8   Club                      16364 non-null  object 
 9   Club Logo                 16364 non-null  object 
 10  Value                     16364 non-null  object 
 11  Wage                      16364 non-null  object 
 12  Special                   16364 non-null  int64  
 13  Preferred Foot            16364 non-null  object 
 14  International Reputation  16364 non-null  float64
 15  Weak Foot                 16364 non-null  float64
 16  Skill Moves               16364 non-null  float64
 17  Work Rate                 16364 non-null  object 
 18  Body Type                 16364 non-null  object 
 19  Real Face                 16364 non-null  object 
 20  Position                  16364 non-null  object 
 21  Joined                    16364 non-null  object 
 22  Contract Valid Until      16364 non-null  object 
 23  Height                    16364 non-null  object 
 24  Weight                    16364 non-null  object 
 25  Release Clause            16364 non-null  float64
 26  Kit Number                16364 non-null  float64
dtypes: float64(5), int64(5), object(17)
memory usage: 3.5+ MB</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>분석의 편의를 위하여 (1) colnames를 변경하고 (2) 결측치를 제거하고 (3) 몇 가지 전 처리를 추가로 진행한 뒤 df2를 만들어서 분석하는게 좋음</p>
</blockquote>
</section>
</section>
<section id="데이터-분석하기" class="level2">
<h2 class="anchored" data-anchor-id="데이터-분석하기">데이터 분석하기</h2>
<section id="overall-vs-potential" class="level3">
<h3 class="anchored" data-anchor-id="overall-vs-potential">Overall vs Potential</h3>
<p>(의문)현재 능력치가 좋은 선수는 잠재력이 없는 거일까?</p>
<div id="445d4bf6-b49d-4998-9734-6e2abf0d7610" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>df.Potential <span class="co"># 잠재능력</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0        88
1        87
2        85
3        91
4        89
         ..
17655    61
17656    64
17657    56
17658    65
17659    61
Name: Potential, Length: 17660, dtype: int64</code></pre>
</div>
</div>
<div id="1cdeb518-4e79-4497-a1a3-8847444f62c9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>df.Overall  <span class="co"># 전반적인</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>0        87
1        86
2        85
3        91
4        86
         ..
17655    48
17656    48
17657    51
17658    50
17659    50
Name: Overall, Length: 17660, dtype: int64</code></pre>
</div>
</div>
<div id="c0a64cf4-4d1c-41ca-8da1-218546c190a8" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> ggplot(data<span class="op">=</span>df) <span class="op">+</span> geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential'</span>))</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="DV_8(1024)_files/figure-html/cell-69-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>뭔가 Potential &gt; Overall 인 관계가 성립하는 듯 하다. <span class="math inline">\(\to\)</span> 우리가 생각하는 포텐셜의 의미는 사실 Potential2 = Potential - Overall 에 더 가깝다. <span class="math inline">\(\to\)</span> Potential2 = Potential - Overall 인 변수를 새로 만들고 시각화 해보자.</li>
</ul>
<p><code>-</code> Potential2 = Potential - Overall 를 계산하여 새로운 열을 추가하자.</p>
<div id="46cd2d6a-9222-4b28-8c00-91d5546956c7" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
<th data-quarto-table-cell-role="th">Potential2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>209658</td>
<td>L. Goretzka</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/209/658/23_60.png</td>
<td>Germany</td>
<td>https://cdn.sofifa.net/flags/de.png</td>
<td>87</td>
<td>88</td>
<td>FC Bayern München</td>
<td>https://cdn.sofifa.net/teams/21/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Jul 1, 2018</td>
<td>NaN</td>
<td>2026</td>
<td>189cm</td>
<td>82kg</td>
<td>€157M</td>
<td>8.0</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>212198</td>
<td>Bruno Fernandes</td>
<td>27</td>
<td>https://cdn.sofifa.net/players/212/198/23_60.png</td>
<td>Portugal</td>
<td>https://cdn.sofifa.net/flags/pt.png</td>
<td>86</td>
<td>87</td>
<td>Manchester United</td>
<td>https://cdn.sofifa.net/teams/11/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos15"&gt;LCM</td>
<td>Jan 30, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>179cm</td>
<td>69kg</td>
<td>€155M</td>
<td>8.0</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>224334</td>
<td>M. Acuña</td>
<td>30</td>
<td>https://cdn.sofifa.net/players/224/334/23_60.png</td>
<td>Argentina</td>
<td>https://cdn.sofifa.net/flags/ar.png</td>
<td>85</td>
<td>85</td>
<td>Sevilla FC</td>
<td>https://cdn.sofifa.net/teams/481/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos7"&gt;LB</td>
<td>Sep 14, 2020</td>
<td>NaN</td>
<td>2024</td>
<td>172cm</td>
<td>69kg</td>
<td>€97.7M</td>
<td>19.0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>192985</td>
<td>K. De Bruyne</td>
<td>31</td>
<td>https://cdn.sofifa.net/players/192/985/23_60.png</td>
<td>Belgium</td>
<td>https://cdn.sofifa.net/flags/be.png</td>
<td>91</td>
<td>91</td>
<td>Manchester City</td>
<td>https://cdn.sofifa.net/teams/10/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Aug 30, 2015</td>
<td>NaN</td>
<td>2025</td>
<td>181cm</td>
<td>70kg</td>
<td>€198.9M</td>
<td>17.0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Sep 1, 2020</td>
<td>NaN</td>
<td>2026</td>
<td>172cm</td>
<td>68kg</td>
<td>€154.4M</td>
<td>23.0</td>
<td>NaN</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>269526</td>
<td>Deng Xiongtao</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>48</td>
<td>61</td>
<td>Meizhou Hakka</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Apr 11, 2022</td>
<td>NaN</td>
<td>2027</td>
<td>190cm</td>
<td>78kg</td>
<td>€218K</td>
<td>35.0</td>
<td>NaN</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>267946</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>17</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>48</td>
<td>64</td>
<td>Jeju United FC</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2022</td>
<td>NaN</td>
<td>2026</td>
<td>195cm</td>
<td>84kg</td>
<td>€188K</td>
<td>21.0</td>
<td>NaN</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>270567</td>
<td>A. Demir</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>Turkey</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>51</td>
<td>56</td>
<td>Ümraniyespor</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jun 6, 2021</td>
<td>NaN</td>
<td>2023</td>
<td>190cm</td>
<td>82kg</td>
<td>€142K</td>
<td>12.0</td>
<td>NaN</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>256624</td>
<td>21&nbsp;S. Czajor</td>
<td>18</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>50</td>
<td>65</td>
<td>Fleetwood Town</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 1, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>187cm</td>
<td>79kg</td>
<td>€214K</td>
<td>40.0</td>
<td>NaN</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>256376</td>
<td>21&nbsp;F. Jakobsson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
<td>Sweden</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>50</td>
<td>61</td>
<td>IFK Norrköping</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
<td>...</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jan 8, 2020</td>
<td>NaN</td>
<td>2021</td>
<td>186cm</td>
<td>78kg</td>
<td>€131K</td>
<td>30.0</td>
<td>NaN</td>
<td>11</td>
</tr>
</tbody>
</table>

<p>17660 rows × 30 columns</p>
</div>
</div>
</div>
<p><code>-</code> 수정된 df에 다시 시각화를 하면</p>
<div id="a680be7d-10f3-4b8f-967f-ceef0de16f69" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>ggplot(data<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>))<span class="op">\</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>),alpha<span class="op">=</span><span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="DV_8(1024)_files/figure-html/cell-71-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="3f596037-69bc-40d4-97ac-7d03580cf6aa" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>ggplot(data<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>))<span class="op">\</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>),alpha<span class="op">=</span><span class="fl">0.05</span>,position<span class="op">=</span><span class="st">'jitter'</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># position='jitter' 흩뿌려진 점</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="DV_8(1024)_files/figure-html/cell-72-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 해석</p>
<ul>
<li><p>해석1: Overall, Potential2는 음의 상관관계가 있다.</p></li>
<li><p>해석2: 0근처에 데이터가 많음.. 이미 은퇴한 선수들이 아닐까?</p></li>
<li><p>해석3: Overall의 값이 작을수록 Potential2의 분산이 크다.</p></li>
</ul>
<p><code>-</code> 은퇴한 선수들을 제외하고 시각화</p>
<div id="a9f29715-827d-44c6-9857-63a294573290" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>ggplot(data<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>))<span class="op">\</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>),alpha<span class="op">=</span><span class="fl">0.05</span>,position<span class="op">=</span><span class="st">'jitter'</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># .query('Potential2 &gt; 1') : 은퇴선수제외, 0에 몰려있는 데이터 제외</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="DV_8(1024)_files/figure-html/cell-73-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> Overall에 따라서 구간을 나누고 그 구간에 대응하는 boxplot을 그리자</p>
<div id="560f6af0-aa2e-44d1-81de-ef0150d53204" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>.Overall.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre><code>count    13644.000000
mean        61.415347
std          7.247821
min         44.000000
25%         56.000000
50%         61.000000
75%         66.000000
max         91.000000
Name: Overall, dtype: float64</code></pre>
</div>
</div>
<div id="965d7b43-5902-4702-b06d-a8377fdc6e5c" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x<span class="op">&gt;</span><span class="dv">66</span>: </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">'66&lt;'</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x<span class="op">&gt;</span><span class="dv">61</span>:</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">'61~66'</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x<span class="op">&gt;</span><span class="dv">56</span>:</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">'56~61'</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">'&lt;56'</span> </span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0f08aa0a-6bda-4b6a-a884-e844ed5ca4f6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>ggplot(data<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall))))<span class="op">\</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> geom_boxplot(aes(x<span class="op">=</span><span class="st">'Overall_grouped'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>NameError: name 'f' is not defined</code></pre>
</div>
</div>
<ul>
<li><p>Overall_grouped = “&lt;56” 에 대응하는 점들을 모두 뽑아서 mean(Overall)를 계산하고 그 값을 Overall_grouped = “&lt;56”에 대응하는 박스플랏의 x축위치로 설정</p></li>
<li><p>Overall_grouped = “56 ~ 61” 에 대응하는 점들을 모두 뽑아서 mean(Overall)를 계산하고 그 값을 Overall_grouped = “56~61” 에 대응하는 박스플랏의 x축위치로 설정</p></li>
<li><p>Overall_grouped = “61 ~ 66” 에 대응하는 점들을 모두 뽑아서 mean(Overall)를 계산하고 그 값을 Overall_grouped = “61 ~ 66” 에 대응하는 박스플랏의 x축위치로 설정</p></li>
<li><p>Overall_grouped = “66&lt;” 에 대응하는 점들을 모두 뽑아서 mean(Overall)를 계산하고 그 값을 Overall_grouped = “66&lt;” 에 대응하는 박스플랏의 x축위치로 설정</p></li>
</ul>
<div id="b262c785-5d1d-44de-84c3-b368799a4267" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall)))<span class="op">\</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>.query(<span class="st">"Overall_grouped == '66&lt;'"</span>).Overall.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>71.8127687727423</code></pre>
</div>
</div>
<p>(방법1)</p>
<div id="05ed16ad-5268-4285-9ca0-e76d78eb5d95" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g(x):</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x<span class="op">==</span><span class="st">'66&lt;'</span>: </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span> <span class="fl">71.8127687727423</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x<span class="op">==</span><span class="st">'61~66'</span>:</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span> <span class="fl">63.773918342474104</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> x<span class="op">==</span><span class="st">'56~61'</span>:</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span> <span class="fl">59.155840684309005</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span> <span class="fl">52.87743190661479</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8450a325-78da-4921-9c17-340446a04148" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall)))<span class="op">\</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>.assign(Overall_x<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(g,df.Overall_grouped)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">Club</th>
<th data-quarto-table-cell-role="th">Club Logo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
<th data-quarto-table-cell-role="th">Potential2</th>
<th data-quarto-table-cell-role="th">Overall_grouped</th>
<th data-quarto-table-cell-role="th">Overall_x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>224232</td>
<td>N. Barella</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/224/232/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>86</td>
<td>89</td>
<td>Inter</td>
<td>https://cdn.sofifa.net/teams/44/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2026</td>
<td>172cm</td>
<td>68kg</td>
<td>€154.4M</td>
<td>23.0</td>
<td>NaN</td>
<td>3</td>
<td>66&lt;</td>
<td>71.812769</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>228251</td>
<td>L. Pellegrini</td>
<td>26</td>
<td>https://cdn.sofifa.net/players/228/251/23_60.png</td>
<td>Italy</td>
<td>https://cdn.sofifa.net/flags/it.png</td>
<td>84</td>
<td>87</td>
<td>Roma</td>
<td>https://cdn.sofifa.net/teams/52/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2026</td>
<td>186cm</td>
<td>77kg</td>
<td>€97.6M</td>
<td>7.0</td>
<td>NaN</td>
<td>3</td>
<td>66&lt;</td>
<td>71.812769</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>225193</td>
<td>Merino</td>
<td>26</td>
<td>https://cdn.sofifa.net/players/225/193/23_60.png</td>
<td>Spain</td>
<td>https://cdn.sofifa.net/flags/es.png</td>
<td>83</td>
<td>86</td>
<td>Real Sociedad</td>
<td>https://cdn.sofifa.net/teams/457/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2025</td>
<td>189cm</td>
<td>83kg</td>
<td>€102.2M</td>
<td>8.0</td>
<td>NaN</td>
<td>3</td>
<td>66&lt;</td>
<td>71.812769</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>228702</td>
<td>F. de Jong</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/228/702/23_60.png</td>
<td>Netherlands</td>
<td>https://cdn.sofifa.net/flags/nl.png</td>
<td>87</td>
<td>92</td>
<td>FC Barcelona</td>
<td>https://cdn.sofifa.net/teams/241/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2026</td>
<td>180cm</td>
<td>74kg</td>
<td>€247.6M</td>
<td>21.0</td>
<td>NaN</td>
<td>5</td>
<td>66&lt;</td>
<td>71.812769</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>231281</td>
<td>T. Alexander-Arnold</td>
<td>23</td>
<td>https://cdn.sofifa.net/players/231/281/23_60.png</td>
<td>England</td>
<td>https://cdn.sofifa.net/flags/gb-eng.png</td>
<td>87</td>
<td>90</td>
<td>Liverpool</td>
<td>https://cdn.sofifa.net/teams/9/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2025</td>
<td>180cm</td>
<td>69kg</td>
<td>€193.5M</td>
<td>66.0</td>
<td>NaN</td>
<td>3</td>
<td>66&lt;</td>
<td>71.812769</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17655</td>
<td>269526</td>
<td>Deng Xiongtao</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/269/526/23_60.png</td>
<td>China PR</td>
<td>https://cdn.sofifa.net/flags/cn.png</td>
<td>48</td>
<td>61</td>
<td>Meizhou Hakka</td>
<td>https://cdn.sofifa.net/teams/114628/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2027</td>
<td>190cm</td>
<td>78kg</td>
<td>€218K</td>
<td>35.0</td>
<td>NaN</td>
<td>13</td>
<td>&lt;56</td>
<td>52.877432</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17656</td>
<td>267946</td>
<td>22&nbsp;Lim Jun Sub</td>
<td>17</td>
<td>https://cdn.sofifa.net/players/267/946/22_60.png</td>
<td>Korea Republic</td>
<td>https://cdn.sofifa.net/flags/kr.png</td>
<td>48</td>
<td>64</td>
<td>Jeju United FC</td>
<td>https://cdn.sofifa.net/teams/1478/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2026</td>
<td>195cm</td>
<td>84kg</td>
<td>€188K</td>
<td>21.0</td>
<td>NaN</td>
<td>16</td>
<td>&lt;56</td>
<td>52.877432</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17657</td>
<td>270567</td>
<td>A. Demir</td>
<td>25</td>
<td>https://cdn.sofifa.net/players/270/567/23_60.png</td>
<td>Turkey</td>
<td>https://cdn.sofifa.net/flags/tr.png</td>
<td>51</td>
<td>56</td>
<td>Ümraniyespor</td>
<td>https://cdn.sofifa.net/teams/113796/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2023</td>
<td>190cm</td>
<td>82kg</td>
<td>€142K</td>
<td>12.0</td>
<td>NaN</td>
<td>5</td>
<td>&lt;56</td>
<td>52.877432</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17658</td>
<td>256624</td>
<td>21&nbsp;S. Czajor</td>
<td>18</td>
<td>https://cdn.sofifa.net/players/256/624/21_60.png</td>
<td>Poland</td>
<td>https://cdn.sofifa.net/flags/pl.png</td>
<td>50</td>
<td>65</td>
<td>Fleetwood Town</td>
<td>https://cdn.sofifa.net/teams/112260/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2021</td>
<td>187cm</td>
<td>79kg</td>
<td>€214K</td>
<td>40.0</td>
<td>NaN</td>
<td>15</td>
<td>&lt;56</td>
<td>52.877432</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17659</td>
<td>256376</td>
<td>21&nbsp;F. Jakobsson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/256/376/21_60.png</td>
<td>Sweden</td>
<td>https://cdn.sofifa.net/flags/se.png</td>
<td>50</td>
<td>61</td>
<td>IFK Norrköping</td>
<td>https://cdn.sofifa.net/teams/702/30.png</td>
<td>...</td>
<td>NaN</td>
<td>2021</td>
<td>186cm</td>
<td>78kg</td>
<td>€131K</td>
<td>30.0</td>
<td>NaN</td>
<td>11</td>
<td>&lt;56</td>
<td>52.877432</td>
</tr>
</tbody>
</table>

<p>13644 rows × 32 columns</p>
</div>
</div>
</div>
<div id="451e10aa-7a95-41bc-aad0-9bb5c5527471" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>df2<span class="op">=</span>df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall)))<span class="op">\</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>.assign(Overall_x<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(g,df.Overall_grouped)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d924e723-7c67-4811-9d81-0c0a864bb1a6" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>ggplot(data<span class="op">=</span>df2)<span class="op">\</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>),position<span class="op">=</span><span class="st">'jitter'</span>,alpha<span class="op">=</span><span class="fl">0.05</span>)<span class="op">\</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>geom_boxplot(aes(x<span class="op">=</span><span class="st">'Overall_x'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(방법2)</p>
<div id="18294a0c-aead-4002-9678-d525b7164953" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>_df <span class="op">=</span> df.<span class="bu">eval</span>(<span class="st">'Potential2 = Potential - Overall'</span>).query(<span class="st">'Potential2 &gt; 1'</span>)<span class="op">\</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>.assign(Overall_grouped<span class="op">=</span> <span class="kw">lambda</span> df: <span class="bu">list</span>(<span class="bu">map</span>(f,df.Overall)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="abea8201-733c-4ecd-b1ef-c30a5d3fc707" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>df3<span class="op">=</span>_df.groupby(by<span class="op">=</span><span class="st">"Overall_grouped"</span>).agg({<span class="st">'Overall'</span>:np.mean}).reset_index()<span class="op">\</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>.rename(columns<span class="op">=</span>{<span class="st">'Overall'</span>:<span class="st">'Overall_x'</span>}).merge(_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f88ed1d2-b990-4945-8266-f5579f8d7c42" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>ggplot(data<span class="op">=</span>df3)<span class="op">\</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>geom_point(aes(x<span class="op">=</span><span class="st">'Overall'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>),position<span class="op">=</span><span class="st">'jitter'</span>,alpha<span class="op">=</span><span class="fl">0.05</span>)<span class="op">\</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>geom_boxplot(aes(x<span class="op">=</span><span class="st">'Overall_x'</span>,y<span class="op">=</span><span class="st">'Potential2'</span>,color<span class="op">=</span><span class="st">'Overall_grouped'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="00f23cef-83d7-44e0-9df5-d8158ec854b5" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>df3.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Overall_grouped</th>
<th data-quarto-table-cell-role="th">Overall_x</th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Photo</th>
<th data-quarto-table-cell-role="th">Nationality</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Overall</th>
<th data-quarto-table-cell-role="th">Potential</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">Joined</th>
<th data-quarto-table-cell-role="th">Loaned From</th>
<th data-quarto-table-cell-role="th">Contract Valid Until</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Release Clause</th>
<th data-quarto-table-cell-role="th">Kit Number</th>
<th data-quarto-table-cell-role="th">Best Overall Rating</th>
<th data-quarto-table-cell-role="th">Potential2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>56~61</td>
<td>59.155841</td>
<td>227288</td>
<td>J. Flores</td>
<td>26</td>
<td>https://cdn.sofifa.net/players/227/288/23_60.png</td>
<td>England</td>
<td>https://cdn.sofifa.net/flags/gb-eng.png</td>
<td>61</td>
<td>64</td>
<td>...</td>
<td>&lt;span class="pos pos9"&gt;RDM</td>
<td>Jan 31, 2022</td>
<td>NaN</td>
<td>2024</td>
<td>180cm</td>
<td>75kg</td>
<td>€609K</td>
<td>21.0</td>
<td>NaN</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>56~61</td>
<td>59.155841</td>
<td>270916</td>
<td>A. Smrcka</td>
<td>19</td>
<td>https://cdn.sofifa.net/players/270/916/23_60.png</td>
<td>Austria</td>
<td>https://cdn.sofifa.net/flags/at.png</td>
<td>60</td>
<td>70</td>
<td>...</td>
<td>&lt;span class="pos pos29"&gt;RES</td>
<td>Jul 1, 2022</td>
<td>NaN</td>
<td>2025</td>
<td>177cm</td>
<td>72kg</td>
<td>€866K</td>
<td>43.0</td>
<td>NaN</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>56~61</td>
<td>59.155841</td>
<td>246789</td>
<td>A. Smith</td>
<td>23</td>
<td>https://cdn.sofifa.net/players/246/789/23_60.png</td>
<td>England</td>
<td>https://cdn.sofifa.net/flags/gb-eng.png</td>
<td>61</td>
<td>66</td>
<td>...</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Jul 1, 2021</td>
<td>NaN</td>
<td>2023</td>
<td>185cm</td>
<td>73kg</td>
<td>€913K</td>
<td>8.0</td>
<td>NaN</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>56~61</td>
<td>59.155841</td>
<td>242056</td>
<td>C. Timmins</td>
<td>22</td>
<td>https://cdn.sofifa.net/players/242/056/23_60.png</td>
<td>Australia</td>
<td>https://cdn.sofifa.net/flags/au.png</td>
<td>61</td>
<td>68</td>
<td>...</td>
<td>&lt;span class="pos pos28"&gt;SUB</td>
<td>Aug 4, 2022</td>
<td>NaN</td>
<td>2023</td>
<td>182cm</td>
<td>72kg</td>
<td>€979K</td>
<td>15.0</td>
<td>NaN</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>56~61</td>
<td>59.155841</td>
<td>262363</td>
<td>22&nbsp;M. Anderson</td>
<td>20</td>
<td>https://cdn.sofifa.net/players/262/363/22_60.png</td>
<td>Scotland</td>
<td>https://cdn.sofifa.net/flags/gb-sct.png</td>
<td>61</td>
<td>71</td>
<td>...</td>
<td>&lt;span class="pos pos13"&gt;RCM</td>
<td>Nov 5, 2019</td>
<td>NaN</td>
<td>2023</td>
<td>167cm</td>
<td>70kg</td>
<td>€1.4M</td>
<td>24.0</td>
<td>NaN</td>
<td>10</td>
</tr>
</tbody>
</table>

<p>5 rows × 32 columns</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="pandas-groupby" class="level1">
<h1>pandas: groupby</h1>
<section id="flights-data" class="level2">
<h2 class="anchored" data-anchor-id="flights-data">flights data</h2>
<div id="c11e5208-12f1-4d6e-b368-0fda710abb40" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'https://raw.githubusercontent.com/PacktPublishing/Pandas-Cookbook/master/data/flights.csv'</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 58492 entries, 0 to 58491
Data columns (total 14 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   MONTH      58492 non-null  int64  
 1   DAY        58492 non-null  int64  
 2   WEEKDAY    58492 non-null  int64  
 3   AIRLINE    58492 non-null  object 
 4   ORG_AIR    58492 non-null  object 
 5   DEST_AIR   58492 non-null  object 
 6   SCHED_DEP  58492 non-null  int64  
 7   DEP_DELAY  57659 non-null  float64
 8   AIR_TIME   57474 non-null  float64
 9   DIST       58492 non-null  int64  
 10  SCHED_ARR  58492 non-null  int64  
 11  ARR_DELAY  57474 non-null  float64
 12  DIVERTED   58492 non-null  int64  
 13  CANCELLED  58492 non-null  int64  
dtypes: float64(3), int64(8), object(3)
memory usage: 6.2+ MB</code></pre>
</div>
</div>
<div id="3254931c-b68e-45d5-9174-da4f4a500b60" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'ARR_DELAY'</span>,<span class="st">'CANCELLED'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>65.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-13.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>35.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-7.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>39.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58487</td>
<td>-19.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58488</td>
<td>4.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58489</td>
<td>-5.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58490</td>
<td>34.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58491</td>
<td>-1.0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>58492 rows × 2 columns</p>
</div>
</div>
</div>
</section>
<section id="get_groups" class="level2">
<h2 class="anchored" data-anchor-id="get_groups">get_groups</h2>
<p><code>-</code> groupby</p>
<ul>
<li><p>데이터프레임을 여러개의 서브데이터프레임으로 나누는 기준</p></li>
<li><p>단독으로 쓸 이유는 별로 없다. <span class="math inline">\(\to\)</span> 그룹을 나누고 그룹을 어떠한 “변수”에 “연산”을 하기 위함이다.</p></li>
</ul>
<div id="77d45494-277f-42aa-87bc-26b4513a875e" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'AIRLINE'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">
<pre><code>array(['WN', 'UA', 'MQ', 'AA', 'F9', 'EV', 'OO', 'NK', 'US', 'AS', 'DL',
       'VX', 'B6', 'HA'], dtype=object)</code></pre>
</div>
</div>
<div id="c8cd0ec2-4d48-4a63-9221-9638cbe31044" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">'AIRLINE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f58e3f69090&gt;</code></pre>
</div>
</div>
<ul>
<li>지금 이것은 항공사별로 데이터프레임이 나누어진 상태</li>
</ul>
<p><code>-</code> sub dataframe으로 나누어져 있는지 확인</p>
<div id="671c2198-2228-43dc-addc-100e64de0672" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> df.groupby(by<span class="op">=</span><span class="st">'AIRLINE'</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>grouped.groups.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">
<pre><code>dict_keys(['AA', 'AS', 'B6', 'DL', 'EV', 'F9', 'HA', 'MQ', 'NK', 'OO', 'UA', 'US', 'VX', 'WN'])</code></pre>
</div>
</div>
<div id="85c415bb-5aa9-40e1-97be-5eaf641dd001" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>grouped.get_group(<span class="st">'AS'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>AS</td>
<td>PHX</td>
<td>SEA</td>
<td>1505</td>
<td>-2.0</td>
<td>155.0</td>
<td>1107</td>
<td>1702</td>
<td>-3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">198</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>AS</td>
<td>LAX</td>
<td>SEA</td>
<td>2110</td>
<td>5.0</td>
<td>145.0</td>
<td>954</td>
<td>2352</td>
<td>8.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">241</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>AS</td>
<td>LAS</td>
<td>PDX</td>
<td>650</td>
<td>-5.0</td>
<td>117.0</td>
<td>763</td>
<td>906</td>
<td>-3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">277</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>AS</td>
<td>ORD</td>
<td>ANC</td>
<td>935</td>
<td>-1.0</td>
<td>402.0</td>
<td>2846</td>
<td>1339</td>
<td>-6.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">397</td>
<td>1</td>
<td>3</td>
<td>6</td>
<td>AS</td>
<td>LAS</td>
<td>SEA</td>
<td>1300</td>
<td>48.0</td>
<td>137.0</td>
<td>867</td>
<td>1535</td>
<td>47.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58305</td>
<td>12</td>
<td>30</td>
<td>3</td>
<td>AS</td>
<td>LAX</td>
<td>SEA</td>
<td>1325</td>
<td>-2.0</td>
<td>134.0</td>
<td>954</td>
<td>1608</td>
<td>-7.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58355</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AS</td>
<td>PHX</td>
<td>SEA</td>
<td>1200</td>
<td>-5.0</td>
<td>145.0</td>
<td>1107</td>
<td>1407</td>
<td>-24.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58404</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AS</td>
<td>SFO</td>
<td>SLC</td>
<td>2110</td>
<td>-2.0</td>
<td>80.0</td>
<td>599</td>
<td>2358</td>
<td>-4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58407</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AS</td>
<td>SFO</td>
<td>PDX</td>
<td>645</td>
<td>-2.0</td>
<td>81.0</td>
<td>550</td>
<td>832</td>
<td>-3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58428</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AS</td>
<td>LAX</td>
<td>SEA</td>
<td>1420</td>
<td>-8.0</td>
<td>127.0</td>
<td>954</td>
<td>1709</td>
<td>-25.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>768 rows × 14 columns</p>
</div>
</div>
</div>
<div id="f63207c5-5338-4713-aa2e-d908ccc188a2" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse_output</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> grouped.groups.keys():</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    display(grouped.get_group(key))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>AA</td>
<td>DFW</td>
<td>DCA</td>
<td>1555</td>
<td>7.0</td>
<td>126.0</td>
<td>1192</td>
<td>1935</td>
<td>-7.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>AA</td>
<td>DFW</td>
<td>MSY</td>
<td>1250</td>
<td>84.0</td>
<td>64.0</td>
<td>447</td>
<td>1410</td>
<td>83.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>AA</td>
<td>ORD</td>
<td>STL</td>
<td>1845</td>
<td>-5.0</td>
<td>44.0</td>
<td>258</td>
<td>1950</td>
<td>-5.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>AA</td>
<td>DEN</td>
<td>DFW</td>
<td>1445</td>
<td>-6.0</td>
<td>93.0</td>
<td>641</td>
<td>1745</td>
<td>4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>AA</td>
<td>LAX</td>
<td>AUS</td>
<td>1430</td>
<td>33.0</td>
<td>157.0</td>
<td>1242</td>
<td>1925</td>
<td>41.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58470</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AA</td>
<td>DFW</td>
<td>FAT</td>
<td>1020</td>
<td>-3.0</td>
<td>196.0</td>
<td>1313</td>
<td>1156</td>
<td>-2.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58475</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AA</td>
<td>IAH</td>
<td>CLT</td>
<td>710</td>
<td>1.0</td>
<td>113.0</td>
<td>912</td>
<td>1037</td>
<td>-12.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58476</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AA</td>
<td>DFW</td>
<td>TPA</td>
<td>1020</td>
<td>-3.0</td>
<td>121.0</td>
<td>929</td>
<td>1340</td>
<td>-6.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58479</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AA</td>
<td>DFW</td>
<td>ELP</td>
<td>1200</td>
<td>3.0</td>
<td>94.0</td>
<td>551</td>
<td>1250</td>
<td>13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58487</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AA</td>
<td>SFO</td>
<td>DFW</td>
<td>515</td>
<td>5.0</td>
<td>166.0</td>
<td>1464</td>
<td>1045</td>
<td>-19.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>8900 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>AS</td>
<td>PHX</td>
<td>SEA</td>
<td>1505</td>
<td>-2.0</td>
<td>155.0</td>
<td>1107</td>
<td>1702</td>
<td>-3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">198</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>AS</td>
<td>LAX</td>
<td>SEA</td>
<td>2110</td>
<td>5.0</td>
<td>145.0</td>
<td>954</td>
<td>2352</td>
<td>8.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">241</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>AS</td>
<td>LAS</td>
<td>PDX</td>
<td>650</td>
<td>-5.0</td>
<td>117.0</td>
<td>763</td>
<td>906</td>
<td>-3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">277</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>AS</td>
<td>ORD</td>
<td>ANC</td>
<td>935</td>
<td>-1.0</td>
<td>402.0</td>
<td>2846</td>
<td>1339</td>
<td>-6.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">397</td>
<td>1</td>
<td>3</td>
<td>6</td>
<td>AS</td>
<td>LAS</td>
<td>SEA</td>
<td>1300</td>
<td>48.0</td>
<td>137.0</td>
<td>867</td>
<td>1535</td>
<td>47.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58305</td>
<td>12</td>
<td>30</td>
<td>3</td>
<td>AS</td>
<td>LAX</td>
<td>SEA</td>
<td>1325</td>
<td>-2.0</td>
<td>134.0</td>
<td>954</td>
<td>1608</td>
<td>-7.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58355</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AS</td>
<td>PHX</td>
<td>SEA</td>
<td>1200</td>
<td>-5.0</td>
<td>145.0</td>
<td>1107</td>
<td>1407</td>
<td>-24.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58404</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AS</td>
<td>SFO</td>
<td>SLC</td>
<td>2110</td>
<td>-2.0</td>
<td>80.0</td>
<td>599</td>
<td>2358</td>
<td>-4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58407</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AS</td>
<td>SFO</td>
<td>PDX</td>
<td>645</td>
<td>-2.0</td>
<td>81.0</td>
<td>550</td>
<td>832</td>
<td>-3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58428</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>AS</td>
<td>LAX</td>
<td>SEA</td>
<td>1420</td>
<td>-8.0</td>
<td>127.0</td>
<td>954</td>
<td>1709</td>
<td>-25.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>768 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">123</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>B6</td>
<td>LAS</td>
<td>BOS</td>
<td>1230</td>
<td>0.0</td>
<td>246.0</td>
<td>2381</td>
<td>2026</td>
<td>-27.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">127</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>B6</td>
<td>LAS</td>
<td>BOS</td>
<td>2359</td>
<td>68.0</td>
<td>247.0</td>
<td>2381</td>
<td>749</td>
<td>46.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">239</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>B6</td>
<td>ORD</td>
<td>BOS</td>
<td>540</td>
<td>-8.0</td>
<td>96.0</td>
<td>867</td>
<td>856</td>
<td>-22.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">333</td>
<td>1</td>
<td>3</td>
<td>6</td>
<td>B6</td>
<td>LAX</td>
<td>FLL</td>
<td>2237</td>
<td>32.0</td>
<td>270.0</td>
<td>2342</td>
<td>619</td>
<td>42.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">548</td>
<td>1</td>
<td>4</td>
<td>7</td>
<td>B6</td>
<td>SFO</td>
<td>FLL</td>
<td>2307</td>
<td>-4.0</td>
<td>298.0</td>
<td>2583</td>
<td>724</td>
<td>-1.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58262</td>
<td>12</td>
<td>30</td>
<td>3</td>
<td>B6</td>
<td>SFO</td>
<td>LGB</td>
<td>1921</td>
<td>-6.0</td>
<td>57.0</td>
<td>354</td>
<td>2038</td>
<td>-14.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58301</td>
<td>12</td>
<td>30</td>
<td>3</td>
<td>B6</td>
<td>LAX</td>
<td>JFK</td>
<td>630</td>
<td>4.0</td>
<td>285.0</td>
<td>2475</td>
<td>1445</td>
<td>-6.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58425</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>B6</td>
<td>ORD</td>
<td>SJU</td>
<td>700</td>
<td>239.0</td>
<td>250.0</td>
<td>2072</td>
<td>1335</td>
<td>239.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58477</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>B6</td>
<td>DFW</td>
<td>BOS</td>
<td>1145</td>
<td>12.0</td>
<td>161.0</td>
<td>1562</td>
<td>1608</td>
<td>-14.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58483</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>B6</td>
<td>PHX</td>
<td>BOS</td>
<td>2236</td>
<td>-12.0</td>
<td>231.0</td>
<td>2300</td>
<td>515</td>
<td>-45.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>543 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">53</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>DL</td>
<td>LAS</td>
<td>MSP</td>
<td>713</td>
<td>-5.0</td>
<td>156.0</td>
<td>1299</td>
<td>1220</td>
<td>-18.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>DL</td>
<td>MSP</td>
<td>RSW</td>
<td>700</td>
<td>-1.0</td>
<td>169.0</td>
<td>1416</td>
<td>1130</td>
<td>-20.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>DL</td>
<td>LAX</td>
<td>ATL</td>
<td>1130</td>
<td>24.0</td>
<td>217.0</td>
<td>1947</td>
<td>1840</td>
<td>16.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">79</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>DL</td>
<td>LAX</td>
<td>CMH</td>
<td>2146</td>
<td>-3.0</td>
<td>223.0</td>
<td>1995</td>
<td>459</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">85</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>DL</td>
<td>ATL</td>
<td>OKC</td>
<td>2059</td>
<td>-4.0</td>
<td>116.0</td>
<td>761</td>
<td>2227</td>
<td>-12.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58440</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>DL</td>
<td>ATL</td>
<td>CVG</td>
<td>1611</td>
<td>-4.0</td>
<td>61.0</td>
<td>373</td>
<td>1736</td>
<td>-6.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58448</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>DL</td>
<td>ATL</td>
<td>SRQ</td>
<td>1610</td>
<td>0.0</td>
<td>61.0</td>
<td>444</td>
<td>1740</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58464</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>DL</td>
<td>LAX</td>
<td>SFO</td>
<td>700</td>
<td>108.0</td>
<td>54.0</td>
<td>337</td>
<td>825</td>
<td>105.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58467</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>DL</td>
<td>ATL</td>
<td>IND</td>
<td>1235</td>
<td>-3.0</td>
<td>63.0</td>
<td>432</td>
<td>1407</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58485</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>DL</td>
<td>ATL</td>
<td>CMH</td>
<td>2206</td>
<td>2.0</td>
<td>64.0</td>
<td>447</td>
<td>2338</td>
<td>-8.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>10601 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>EV</td>
<td>ORD</td>
<td>JAN</td>
<td>1155</td>
<td>6.0</td>
<td>113.0</td>
<td>677</td>
<td>1403</td>
<td>5.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>EV</td>
<td>ORD</td>
<td>CMH</td>
<td>1010</td>
<td>-2.0</td>
<td>46.0</td>
<td>296</td>
<td>1228</td>
<td>-9.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>EV</td>
<td>ORD</td>
<td>IND</td>
<td>1025</td>
<td>-6.0</td>
<td>29.0</td>
<td>177</td>
<td>1228</td>
<td>-19.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">40</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>EV</td>
<td>IAH</td>
<td>CLE</td>
<td>1038</td>
<td>-3.0</td>
<td>126.0</td>
<td>1091</td>
<td>1425</td>
<td>-18.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">69</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>EV</td>
<td>ATL</td>
<td>RAP</td>
<td>1930</td>
<td>-5.0</td>
<td>181.0</td>
<td>1230</td>
<td>2104</td>
<td>-15.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58445</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>EV</td>
<td>DFW</td>
<td>TXK</td>
<td>850</td>
<td>-5.0</td>
<td>30.0</td>
<td>181</td>
<td>948</td>
<td>-17.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58452</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>EV</td>
<td>DFW</td>
<td>SHV</td>
<td>1650</td>
<td>-4.0</td>
<td>32.0</td>
<td>190</td>
<td>1746</td>
<td>-12.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58459</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>EV</td>
<td>MSP</td>
<td>ORD</td>
<td>1435</td>
<td>18.0</td>
<td>61.0</td>
<td>334</td>
<td>1609</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58463</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>EV</td>
<td>ORD</td>
<td>MSN</td>
<td>1220</td>
<td>18.0</td>
<td>32.0</td>
<td>108</td>
<td>1319</td>
<td>27.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58486</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>EV</td>
<td>DFW</td>
<td>LFT</td>
<td>850</td>
<td>21.0</td>
<td>52.0</td>
<td>351</td>
<td>1012</td>
<td>14.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>5858 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>F9</td>
<td>SFO</td>
<td>PHX</td>
<td>1020</td>
<td>-7.0</td>
<td>91.0</td>
<td>651</td>
<td>1315</td>
<td>-6.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">93</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>F9</td>
<td>ATL</td>
<td>DEN</td>
<td>859</td>
<td>16.0</td>
<td>181.0</td>
<td>1199</td>
<td>1026</td>
<td>10.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">209</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>F9</td>
<td>MSP</td>
<td>DEN</td>
<td>1025</td>
<td>-6.0</td>
<td>97.0</td>
<td>680</td>
<td>1134</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">232</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>F9</td>
<td>DEN</td>
<td>PHX</td>
<td>2040</td>
<td>-7.0</td>
<td>83.0</td>
<td>602</td>
<td>2228</td>
<td>-18.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">247</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>F9</td>
<td>ORD</td>
<td>ATL</td>
<td>730</td>
<td>10.0</td>
<td>86.0</td>
<td>606</td>
<td>1020</td>
<td>23.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58288</td>
<td>12</td>
<td>30</td>
<td>3</td>
<td>F9</td>
<td>DEN</td>
<td>ORD</td>
<td>625</td>
<td>-4.0</td>
<td>136.0</td>
<td>888</td>
<td>1000</td>
<td>14.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58331</td>
<td>12</td>
<td>30</td>
<td>3</td>
<td>F9</td>
<td>ORD</td>
<td>PHX</td>
<td>825</td>
<td>18.0</td>
<td>207.0</td>
<td>1440</td>
<td>1127</td>
<td>14.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58447</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>F9</td>
<td>DEN</td>
<td>LAS</td>
<td>1245</td>
<td>13.0</td>
<td>94.0</td>
<td>628</td>
<td>1340</td>
<td>13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58449</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>F9</td>
<td>DEN</td>
<td>MCO</td>
<td>645</td>
<td>11.0</td>
<td>169.0</td>
<td>1546</td>
<td>1224</td>
<td>-11.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58488</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>F9</td>
<td>LAS</td>
<td>SFO</td>
<td>1910</td>
<td>13.0</td>
<td>71.0</td>
<td>414</td>
<td>2050</td>
<td>4.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>1317 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">582</td>
<td>1</td>
<td>4</td>
<td>7</td>
<td>HA</td>
<td>LAX</td>
<td>OGG</td>
<td>1115</td>
<td>-11.0</td>
<td>310.0</td>
<td>2486</td>
<td>1500</td>
<td>-27.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">712</td>
<td>1</td>
<td>5</td>
<td>1</td>
<td>HA</td>
<td>LAS</td>
<td>HNL</td>
<td>900</td>
<td>-5.0</td>
<td>357.0</td>
<td>2762</td>
<td>1315</td>
<td>5.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">878</td>
<td>1</td>
<td>6</td>
<td>2</td>
<td>HA</td>
<td>PHX</td>
<td>HNL</td>
<td>800</td>
<td>1.0</td>
<td>374.0</td>
<td>2917</td>
<td>1140</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1053</td>
<td>1</td>
<td>7</td>
<td>3</td>
<td>HA</td>
<td>LAX</td>
<td>HNL</td>
<td>1705</td>
<td>0.0</td>
<td>332.0</td>
<td>2556</td>
<td>2055</td>
<td>-2.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1269</td>
<td>1</td>
<td>8</td>
<td>4</td>
<td>HA</td>
<td>LAX</td>
<td>HNL</td>
<td>1000</td>
<td>-1.0</td>
<td>335.0</td>
<td>2556</td>
<td>1350</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">55883</td>
<td>12</td>
<td>16</td>
<td>3</td>
<td>HA</td>
<td>LAX</td>
<td>HNL</td>
<td>835</td>
<td>1.0</td>
<td>314.0</td>
<td>2556</td>
<td>1235</td>
<td>-18.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56174</td>
<td>12</td>
<td>18</td>
<td>5</td>
<td>HA</td>
<td>LAX</td>
<td>HNL</td>
<td>835</td>
<td>-5.0</td>
<td>342.0</td>
<td>2556</td>
<td>1235</td>
<td>-4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">56350</td>
<td>12</td>
<td>19</td>
<td>6</td>
<td>HA</td>
<td>PHX</td>
<td>HNL</td>
<td>800</td>
<td>-5.0</td>
<td>363.0</td>
<td>2917</td>
<td>1155</td>
<td>-34.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">56816</td>
<td>12</td>
<td>21</td>
<td>1</td>
<td>HA</td>
<td>LAX</td>
<td>LIH</td>
<td>740</td>
<td>20.0</td>
<td>303.0</td>
<td>2615</td>
<td>1145</td>
<td>-11.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58391</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>HA</td>
<td>LAX</td>
<td>HNL</td>
<td>1000</td>
<td>0.0</td>
<td>324.0</td>
<td>2556</td>
<td>1350</td>
<td>-9.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>112 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>MQ</td>
<td>DFW</td>
<td>VPS</td>
<td>1305</td>
<td>36.0</td>
<td>85.0</td>
<td>641</td>
<td>1453</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>MQ</td>
<td>DFW</td>
<td>DRO</td>
<td>1335</td>
<td>28.0</td>
<td>104.0</td>
<td>674</td>
<td>1438</td>
<td>28.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>MQ</td>
<td>ORD</td>
<td>DAY</td>
<td>2220</td>
<td>19.0</td>
<td>37.0</td>
<td>240</td>
<td>23</td>
<td>20.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>MQ</td>
<td>DFW</td>
<td>BTR</td>
<td>730</td>
<td>NaN</td>
<td>NaN</td>
<td>383</td>
<td>853</td>
<td>NaN</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>MQ</td>
<td>ORD</td>
<td>CID</td>
<td>1135</td>
<td>-7.0</td>
<td>37.0</td>
<td>196</td>
<td>1238</td>
<td>-15.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58415</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>MQ</td>
<td>ORD</td>
<td>FWA</td>
<td>845</td>
<td>-2.0</td>
<td>37.0</td>
<td>157</td>
<td>1045</td>
<td>-4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58426</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>MQ</td>
<td>DFW</td>
<td>FAR</td>
<td>1154</td>
<td>4.0</td>
<td>124.0</td>
<td>968</td>
<td>1437</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58468</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>MQ</td>
<td>DFW</td>
<td>OKC</td>
<td>1720</td>
<td>-3.0</td>
<td>31.0</td>
<td>175</td>
<td>1819</td>
<td>-10.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58474</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>MQ</td>
<td>ORD</td>
<td>FNT</td>
<td>829</td>
<td>4.0</td>
<td>40.0</td>
<td>223</td>
<td>1034</td>
<td>-4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58484</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>MQ</td>
<td>ORD</td>
<td>DSM</td>
<td>1333</td>
<td>1.0</td>
<td>57.0</td>
<td>299</td>
<td>1455</td>
<td>-7.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>3471 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>NK</td>
<td>DEN</td>
<td>DTW</td>
<td>1952</td>
<td>37.0</td>
<td>124.0</td>
<td>1123</td>
<td>31</td>
<td>54.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">74</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>NK</td>
<td>PHX</td>
<td>DFW</td>
<td>159</td>
<td>-1.0</td>
<td>103.0</td>
<td>868</td>
<td>502</td>
<td>1.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">95</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>NK</td>
<td>LAS</td>
<td>OAK</td>
<td>1115</td>
<td>22.0</td>
<td>62.0</td>
<td>407</td>
<td>1246</td>
<td>10.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">109</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>NK</td>
<td>MSP</td>
<td>ORD</td>
<td>616</td>
<td>2.0</td>
<td>49.0</td>
<td>334</td>
<td>745</td>
<td>-19.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">166</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>NK</td>
<td>LAS</td>
<td>PDX</td>
<td>1535</td>
<td>-8.0</td>
<td>123.0</td>
<td>763</td>
<td>1754</td>
<td>-4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58160</td>
<td>12</td>
<td>29</td>
<td>2</td>
<td>NK</td>
<td>MSP</td>
<td>MCO</td>
<td>740</td>
<td>0.0</td>
<td>171.0</td>
<td>1310</td>
<td>1158</td>
<td>33.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58197</td>
<td>12</td>
<td>30</td>
<td>3</td>
<td>NK</td>
<td>IAH</td>
<td>ORD</td>
<td>755</td>
<td>-8.0</td>
<td>136.0</td>
<td>925</td>
<td>1030</td>
<td>-2.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58437</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>NK</td>
<td>ORD</td>
<td>DFW</td>
<td>1952</td>
<td>15.0</td>
<td>135.0</td>
<td>802</td>
<td>2225</td>
<td>23.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58461</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>NK</td>
<td>ORD</td>
<td>LGA</td>
<td>1801</td>
<td>-5.0</td>
<td>84.0</td>
<td>733</td>
<td>2109</td>
<td>-26.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58469</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>NK</td>
<td>LAS</td>
<td>MSY</td>
<td>1950</td>
<td>124.0</td>
<td>163.0</td>
<td>1500</td>
<td>112</td>
<td>101.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>1516 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>OO</td>
<td>ORD</td>
<td>MSP</td>
<td>1510</td>
<td>2.0</td>
<td>65.0</td>
<td>334</td>
<td>1646</td>
<td>4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>OO</td>
<td>DEN</td>
<td>SGU</td>
<td>1105</td>
<td>21.0</td>
<td>66.0</td>
<td>517</td>
<td>1249</td>
<td>20.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>OO</td>
<td>LAS</td>
<td>LAX</td>
<td>1544</td>
<td>-4.0</td>
<td>39.0</td>
<td>236</td>
<td>1655</td>
<td>-12.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>OO</td>
<td>ORD</td>
<td>SPI</td>
<td>2110</td>
<td>-4.0</td>
<td>31.0</td>
<td>174</td>
<td>2205</td>
<td>5.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>OO</td>
<td>IAH</td>
<td>JAC</td>
<td>1104</td>
<td>-1.0</td>
<td>161.0</td>
<td>1265</td>
<td>1316</td>
<td>-1.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58451</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>OO</td>
<td>ATL</td>
<td>FWA</td>
<td>1905</td>
<td>-3.0</td>
<td>72.0</td>
<td>508</td>
<td>2051</td>
<td>-14.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58480</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>OO</td>
<td>MSP</td>
<td>BIS</td>
<td>1310</td>
<td>-2.0</td>
<td>65.0</td>
<td>386</td>
<td>1449</td>
<td>-9.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58482</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>OO</td>
<td>DEN</td>
<td>CPR</td>
<td>1850</td>
<td>-2.0</td>
<td>38.0</td>
<td>230</td>
<td>1956</td>
<td>1.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58489</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>OO</td>
<td>SFO</td>
<td>SBA</td>
<td>1846</td>
<td>-6.0</td>
<td>46.0</td>
<td>262</td>
<td>1956</td>
<td>-5.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58491</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>OO</td>
<td>SFO</td>
<td>BOI</td>
<td>859</td>
<td>5.0</td>
<td>73.0</td>
<td>522</td>
<td>1146</td>
<td>-1.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>6588 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>UA</td>
<td>DEN</td>
<td>IAD</td>
<td>823</td>
<td>7.0</td>
<td>154.0</td>
<td>1452</td>
<td>1333</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>UA</td>
<td>IAH</td>
<td>SAN</td>
<td>1450</td>
<td>1.0</td>
<td>178.0</td>
<td>1303</td>
<td>1620</td>
<td>-14.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>UA</td>
<td>IAH</td>
<td>SJC</td>
<td>925</td>
<td>3.0</td>
<td>215.0</td>
<td>1608</td>
<td>1136</td>
<td>-14.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>UA</td>
<td>IAH</td>
<td>IND</td>
<td>1426</td>
<td>-1.0</td>
<td>102.0</td>
<td>844</td>
<td>1742</td>
<td>-20.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>UA</td>
<td>ORD</td>
<td>CLE</td>
<td>2102</td>
<td>48.0</td>
<td>47.0</td>
<td>315</td>
<td>2320</td>
<td>41.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58422</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>UA</td>
<td>DEN</td>
<td>SAN</td>
<td>1535</td>
<td>0.0</td>
<td>124.0</td>
<td>853</td>
<td>1704</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58432</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>UA</td>
<td>ORD</td>
<td>SAN</td>
<td>1915</td>
<td>7.0</td>
<td>238.0</td>
<td>1723</td>
<td>2143</td>
<td>-3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58457</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>UA</td>
<td>ORD</td>
<td>LAX</td>
<td>659</td>
<td>-1.0</td>
<td>241.0</td>
<td>1744</td>
<td>946</td>
<td>0.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58460</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>UA</td>
<td>SFO</td>
<td>PHL</td>
<td>2235</td>
<td>-6.0</td>
<td>265.0</td>
<td>2521</td>
<td>700</td>
<td>-42.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58481</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>UA</td>
<td>IAH</td>
<td>LAX</td>
<td>1433</td>
<td>1.0</td>
<td>197.0</td>
<td>1379</td>
<td>1625</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>7792 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">31</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>US</td>
<td>PHX</td>
<td>DEN</td>
<td>1810</td>
<td>29.0</td>
<td>94.0</td>
<td>602</td>
<td>1954</td>
<td>49.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>US</td>
<td>ORD</td>
<td>PHL</td>
<td>1600</td>
<td>-2.0</td>
<td>80.0</td>
<td>678</td>
<td>1857</td>
<td>-9.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">49</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>US</td>
<td>IAH</td>
<td>PHX</td>
<td>1445</td>
<td>-1.0</td>
<td>147.0</td>
<td>1009</td>
<td>1638</td>
<td>-7.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">96</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>US</td>
<td>ATL</td>
<td>PHL</td>
<td>1445</td>
<td>-4.0</td>
<td>90.0</td>
<td>666</td>
<td>1644</td>
<td>-11.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">104</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>US</td>
<td>MSP</td>
<td>PHX</td>
<td>730</td>
<td>-3.0</td>
<td>174.0</td>
<td>1276</td>
<td>1010</td>
<td>-20.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31514</td>
<td>6</td>
<td>30</td>
<td>2</td>
<td>US</td>
<td>DEN</td>
<td>PHL</td>
<td>705</td>
<td>-4.0</td>
<td>188.0</td>
<td>1558</td>
<td>1240</td>
<td>1.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31523</td>
<td>6</td>
<td>30</td>
<td>2</td>
<td>US</td>
<td>PHX</td>
<td>DEN</td>
<td>1451</td>
<td>6.0</td>
<td>85.0</td>
<td>602</td>
<td>1738</td>
<td>7.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31535</td>
<td>6</td>
<td>30</td>
<td>2</td>
<td>US</td>
<td>PHX</td>
<td>AUS</td>
<td>840</td>
<td>-3.0</td>
<td>116.0</td>
<td>872</td>
<td>1304</td>
<td>-11.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31561</td>
<td>6</td>
<td>30</td>
<td>2</td>
<td>US</td>
<td>ORD</td>
<td>PHX</td>
<td>710</td>
<td>-5.0</td>
<td>170.0</td>
<td>1440</td>
<td>901</td>
<td>-50.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">31582</td>
<td>6</td>
<td>30</td>
<td>2</td>
<td>US</td>
<td>PHX</td>
<td>OGG</td>
<td>800</td>
<td>-4.0</td>
<td>356.0</td>
<td>2845</td>
<td>1127</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>1615 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">56</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>VX</td>
<td>LAS</td>
<td>SFO</td>
<td>900</td>
<td>23.0</td>
<td>65.0</td>
<td>414</td>
<td>1035</td>
<td>11.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">227</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>VX</td>
<td>SFO</td>
<td>LAS</td>
<td>1220</td>
<td>-5.0</td>
<td>68.0</td>
<td>414</td>
<td>1350</td>
<td>-5.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">243</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>VX</td>
<td>SFO</td>
<td>SEA</td>
<td>700</td>
<td>-4.0</td>
<td>104.0</td>
<td>679</td>
<td>905</td>
<td>-1.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">417</td>
<td>1</td>
<td>3</td>
<td>6</td>
<td>VX</td>
<td>SFO</td>
<td>LAS</td>
<td>900</td>
<td>-2.0</td>
<td>62.0</td>
<td>414</td>
<td>1030</td>
<td>-11.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">432</td>
<td>1</td>
<td>3</td>
<td>6</td>
<td>VX</td>
<td>SFO</td>
<td>SEA</td>
<td>2035</td>
<td>-2.0</td>
<td>106.0</td>
<td>679</td>
<td>2240</td>
<td>-2.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58332</td>
<td>12</td>
<td>30</td>
<td>3</td>
<td>VX</td>
<td>SFO</td>
<td>LAS</td>
<td>1950</td>
<td>-3.0</td>
<td>58.0</td>
<td>414</td>
<td>2120</td>
<td>-4.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58383</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>VX</td>
<td>SFO</td>
<td>PSP</td>
<td>1630</td>
<td>-7.0</td>
<td>65.0</td>
<td>421</td>
<td>1755</td>
<td>-12.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58400</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>VX</td>
<td>SFO</td>
<td>LAX</td>
<td>1125</td>
<td>-4.0</td>
<td>54.0</td>
<td>337</td>
<td>1245</td>
<td>-10.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58471</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>VX</td>
<td>SFO</td>
<td>LAX</td>
<td>700</td>
<td>6.0</td>
<td>51.0</td>
<td>337</td>
<td>820</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58478</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>VX</td>
<td>SFO</td>
<td>LAX</td>
<td>1530</td>
<td>29.0</td>
<td>52.0</td>
<td>337</td>
<td>1650</td>
<td>22.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>993 rows × 14 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MONTH</th>
<th data-quarto-table-cell-role="th">DAY</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">ORG_AIR</th>
<th data-quarto-table-cell-role="th">DEST_AIR</th>
<th data-quarto-table-cell-role="th">SCHED_DEP</th>
<th data-quarto-table-cell-role="th">DEP_DELAY</th>
<th data-quarto-table-cell-role="th">AIR_TIME</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">SCHED_ARR</th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
<th data-quarto-table-cell-role="th">DIVERTED</th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>WN</td>
<td>LAX</td>
<td>SLC</td>
<td>1625</td>
<td>58.0</td>
<td>94.0</td>
<td>590</td>
<td>1905</td>
<td>65.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>WN</td>
<td>LAX</td>
<td>MCI</td>
<td>1720</td>
<td>48.0</td>
<td>166.0</td>
<td>1363</td>
<td>2225</td>
<td>39.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>WN</td>
<td>PHX</td>
<td>LAX</td>
<td>1640</td>
<td>51.0</td>
<td>58.0</td>
<td>370</td>
<td>1700</td>
<td>59.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>WN</td>
<td>ATL</td>
<td>BWI</td>
<td>1115</td>
<td>1.0</td>
<td>76.0</td>
<td>577</td>
<td>1305</td>
<td>-15.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>WN</td>
<td>ATL</td>
<td>HOU</td>
<td>1555</td>
<td>30.0</td>
<td>113.0</td>
<td>696</td>
<td>1720</td>
<td>18.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58455</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>WN</td>
<td>LAX</td>
<td>SMF</td>
<td>1420</td>
<td>-2.0</td>
<td>64.0</td>
<td>373</td>
<td>1540</td>
<td>-7.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58458</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>WN</td>
<td>LAS</td>
<td>SFO</td>
<td>1825</td>
<td>25.0</td>
<td>67.0</td>
<td>414</td>
<td>1955</td>
<td>17.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58472</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>WN</td>
<td>PHX</td>
<td>HOU</td>
<td>845</td>
<td>5.0</td>
<td>119.0</td>
<td>1020</td>
<td>1210</td>
<td>7.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">58473</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>WN</td>
<td>DEN</td>
<td>PDX</td>
<td>1205</td>
<td>4.0</td>
<td>130.0</td>
<td>991</td>
<td>1400</td>
<td>-13.0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58490</td>
<td>12</td>
<td>31</td>
<td>4</td>
<td>WN</td>
<td>MSP</td>
<td>ATL</td>
<td>525</td>
<td>39.0</td>
<td>124.0</td>
<td>907</td>
<td>855</td>
<td>34.0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>8418 rows × 14 columns</p>
</div>
</div>
</div>
</section>
<section id="범주형-변수를-기준으로-groupby---agg" class="level2">
<h2 class="anchored" data-anchor-id="범주형-변수를-기준으로-groupby---agg">범주형 변수를 기준으로 groupby -&gt; agg</h2>
<section id="ex1-airline-to-arr_delaymean" class="level3">
<h3 class="anchored" data-anchor-id="ex1-airline-to-arr_delaymean">EX1: [AIRLINE] <span class="math inline">\(\to\)</span> {ARR_DELAY:mean}</h3>
<p><code>-</code> 방법1: groupby() <span class="math inline">\(\to\)</span> .agg({colname: function})</p>
<div id="137ac704-4b32-4c21-824c-a21f2dd7df43" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f5900e60850&gt;</code></pre>
</div>
</div>
<div id="d4dc7a43-412c-4545-8fd0-795f538f516c" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>df.AIRLINE.unique().<span class="fu">__len__</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>14</code></pre>
</div>
</div>
<p>(예시1)</p>
<div id="e8da2d77-96b2-4a8a-87d8-fe0c446e691e" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>).agg({<span class="st">'ARR_DELAY'</span>:np.mean})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AA</td>
<td>5.542661</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AS</td>
<td>-0.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">B6</td>
<td>8.692593</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DL</td>
<td>0.339691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">EV</td>
<td>7.034580</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">F9</td>
<td>13.630651</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HA</td>
<td>4.972973</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MQ</td>
<td>6.860591</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NK</td>
<td>18.436070</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OO</td>
<td>7.593463</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">UA</td>
<td>7.765755</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">US</td>
<td>1.681105</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VX</td>
<td>5.348884</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">WN</td>
<td>6.397353</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>(예시2)</p>
<div id="52978c43-bf05-4f3f-849a-ffb930e0b870" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>).agg({<span class="st">'ARR_DELAY'</span>:mean})</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co"># numpy로 하지 않고 mean만을 해도 된다</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AA</td>
<td>5.542661</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AS</td>
<td>-0.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">B6</td>
<td>8.692593</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DL</td>
<td>0.339691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">EV</td>
<td>7.034580</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">F9</td>
<td>13.630651</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HA</td>
<td>4.972973</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MQ</td>
<td>6.860591</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NK</td>
<td>18.436070</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OO</td>
<td>7.593463</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">UA</td>
<td>7.765755</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">US</td>
<td>1.681105</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VX</td>
<td>5.348884</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">WN</td>
<td>6.397353</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>(실습)</p>
<div id="f589892a-abb5-4ad9-aa2b-26fd7d2ae6a6" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>).agg({<span class="st">'ARR_DELAY'</span>:std})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AA</td>
<td>43.323160</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AS</td>
<td>31.168354</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">B6</td>
<td>40.221718</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DL</td>
<td>32.299471</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">EV</td>
<td>36.682336</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">F9</td>
<td>53.030912</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HA</td>
<td>37.528283</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MQ</td>
<td>36.324657</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NK</td>
<td>48.727259</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OO</td>
<td>35.331344</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">UA</td>
<td>46.405935</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">US</td>
<td>27.030227</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VX</td>
<td>33.747675</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">WN</td>
<td>32.610666</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="0db4ad9a-baec-452b-b595-6cc250cb888c" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">"AIRLINE"</span>).agg({<span class="st">'ARR_DELAY'</span>:<span class="bu">max</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ARR_DELAY</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AA</td>
<td>858.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AS</td>
<td>344.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">B6</td>
<td>331.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DL</td>
<td>741.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">EV</td>
<td>669.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">F9</td>
<td>839.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">HA</td>
<td>298.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MQ</td>
<td>357.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NK</td>
<td>474.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">OO</td>
<td>724.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">UA</td>
<td>1185.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">US</td>
<td>431.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VX</td>
<td>236.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">WN</td>
<td>493.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>-</code> 방법2: groupby() <span class="math inline">\(\to\)</span> key로 column 선택 <span class="math inline">\(\to\)</span> .agg(function) or .function()</p>
<p>(예시1)</p>
<div id="992145a0-ddb9-4296-b4bd-5b6084c16e37" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">'AIRLINE'</span>)[<span class="st">'ARR_DELAY'</span>].agg(np.mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<pre><code>AIRLINE
AA     5.542661
AS    -0.833333
B6     8.692593
DL     0.339691
EV     7.034580
F9    13.630651
HA     4.972973
MQ     6.860591
NK    18.436070
OO     7.593463
UA     7.765755
US     1.681105
VX     5.348884
WN     6.397353
Name: ARR_DELAY, dtype: float64</code></pre>
</div>
</div>
<p>(예시2)</p>
<div id="6c8449af-7e7e-425e-b76f-6fad59e28e0d" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">'AIRLINE'</span>)[<span class="st">'ARR_DELAY'</span>].agg(mean)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mean에 " " 들어가도 된다</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>AIRLINE
AA     5.542661
AS    -0.833333
B6     8.692593
DL     0.339691
EV     7.034580
F9    13.630651
HA     4.972973
MQ     6.860591
NK    18.436070
OO     7.593463
UA     7.765755
US     1.681105
VX     5.348884
WN     6.397353
Name: ARR_DELAY, dtype: float64</code></pre>
</div>
</div>
<p>(예시3)</p>
<div id="e71bcdf2-e361-4f3d-acc9-b08c40530e8b" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span><span class="st">'AIRLINE'</span>)[<span class="st">'ARR_DELAY'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">
<pre><code>AIRLINE
AA     5.542661
AS    -0.833333
B6     8.692593
DL     0.339691
EV     7.034580
F9    13.630651
HA     4.972973
MQ     6.860591
NK    18.436070
OO     7.593463
UA     7.765755
US     1.681105
VX     5.348884
WN     6.397353
Name: ARR_DELAY, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="ex2-airline-weekday-to-cancelledmean" class="level3">
<h3 class="anchored" data-anchor-id="ex2-airline-weekday-to-cancelledmean">EX2: [AIRLINE, WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:mean}</h3>
<p><code>-</code> 방법1</p>
<p>(예시1)</p>
<div id="5bd70ff5-9d2a-4fdc-8b15-cf15639a9f3b" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">'AIRLINE'</span>, <span class="st">'WEEKDAY'</span>]).agg({<span class="st">'CANCELLED'</span>:np.<span class="bu">sum</span>})</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 몇요일에 항공사별로 취소가 많이 되었는지 (sum)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
</tr>
</tbody>
</table>

<p>98 rows × 1 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div id="afbc281d-2dfa-4ccc-b712-4ede4fb1af4d" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">'AIRLINE'</span>, <span class="st">'WEEKDAY'</span>]).agg({<span class="st">'CANCELLED'</span>:<span class="bu">sum</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
</tr>
</tbody>
</table>

<p>98 rows × 1 columns</p>
</div>
</div>
</div>
<p><code>-</code> 방법2</p>
<p>(예시1)</p>
<div id="90976489-4ea3-4202-a8ef-d760fbb4b179" class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">'AIRLINE'</span>, <span class="st">'WEEKDAY'</span>])[<span class="st">"CANCELLED"</span>].agg(np.<span class="bu">sum</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>AIRLINE  WEEKDAY
AA       1          41
         2           9
         3          16
         4          20
         5          18
                    ..
WN       3          18
         4          10
         5           7
         6          10
         7           7
Name: CANCELLED, Length: 98, dtype: int64</code></pre>
</div>
</div>
<p>(예시2)</p>
<div id="58b38336-fcaf-4fdb-a9d0-9ed4c1972796" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">'AIRLINE'</span>, <span class="st">'WEEKDAY'</span>])[<span class="st">"CANCELLED"</span>].agg(<span class="st">"sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">
<pre><code>AIRLINE  WEEKDAY
AA       1          41
         2           9
         3          16
         4          20
         5          18
                    ..
WN       3          18
         4          10
         5           7
         6          10
         7           7
Name: CANCELLED, Length: 98, dtype: int64</code></pre>
</div>
</div>
<p>(예시3)</p>
<div id="e958fb32-c71d-4b1c-9745-006fb159df07" class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">'AIRLINE'</span>, <span class="st">'WEEKDAY'</span>])[<span class="st">"CANCELLED"</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<pre><code>AIRLINE  WEEKDAY
AA       1          41
         2           9
         3          16
         4          20
         5          18
                    ..
WN       3          18
         4          10
         5           7
         6          10
         7           7
Name: CANCELLED, Length: 98, dtype: int64</code></pre>
</div>
</div>
<div id="32cf04da-8db6-4dae-9156-9272fd415ba1" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">'AIRLINE'</span>, <span class="st">'WEEKDAY'</span>])[[<span class="st">"CANCELLED"</span>]].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CANCELLED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
</tr>
</tbody>
</table>

<p>98 rows × 1 columns</p>
</div>
</div>
</div>
</section>
<section id="ex3-airlineweekday-to-cancelledsummean-diverted-summean" class="level3">
<h3 class="anchored" data-anchor-id="ex3-airlineweekday-to-cancelledsummean-diverted-summean">EX3: [AIRLINE,WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:sum,mean}, {DIVERTED: sum,mean}</h3>
<p><code>-</code> 방법1</p>
<p>(예시1)</p>
<div id="11e22bdd-04de-4a07-9c67-0a1ba1f8fc92" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])<span class="op">\</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>.agg({<span class="st">"CANCELLED"</span>:[np.<span class="bu">sum</span>,np.mean],<span class="st">"DIVERTED"</span>:[np.<span class="bu">sum</span>,np.mean]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">DIVERTED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
<td>0.032106</td>
<td>6</td>
<td>0.004699</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>0.007341</td>
<td>2</td>
<td>0.001631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
<td>0.011949</td>
<td>2</td>
<td>0.001494</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
<td>0.015004</td>
<td>5</td>
<td>0.003751</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
<td>0.014151</td>
<td>1</td>
<td>0.000786</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>0.014118</td>
<td>2</td>
<td>0.001569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
<td>0.007911</td>
<td>4</td>
<td>0.003165</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
<td>0.005828</td>
<td>0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
<td>0.010132</td>
<td>3</td>
<td>0.003040</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>0.006066</td>
<td>3</td>
<td>0.002600</td>
</tr>
</tbody>
</table>

<p>98 rows × 4 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div id="13c13c0a-1112-417e-b853-dd56a406d431" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>6</code></pre>
</div>
</div>
<div id="447799e0-0b4c-40f1-bf50-8c2085272021" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])<span class="op">\</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>.agg({<span class="st">"CANCELLED"</span>:[<span class="bu">sum</span>,np.mean],<span class="st">"DIVERTED"</span>:[<span class="bu">sum</span>,np.mean]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">DIVERTED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
<td>0.032106</td>
<td>6</td>
<td>0.004699</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>0.007341</td>
<td>2</td>
<td>0.001631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
<td>0.011949</td>
<td>2</td>
<td>0.001494</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
<td>0.015004</td>
<td>5</td>
<td>0.003751</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
<td>0.014151</td>
<td>1</td>
<td>0.000786</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>0.014118</td>
<td>2</td>
<td>0.001569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
<td>0.007911</td>
<td>4</td>
<td>0.003165</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
<td>0.005828</td>
<td>0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
<td>0.010132</td>
<td>3</td>
<td>0.003040</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>0.006066</td>
<td>3</td>
<td>0.002600</td>
</tr>
</tbody>
</table>

<p>98 rows × 4 columns</p>
</div>
</div>
</div>
<p><code>-</code> 방법2</p>
<p>(예시1)</p>
<div id="e3e78e2e-e852-41cf-848a-2d6acc39ea19" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])[[<span class="st">"CANCELLED"</span>,<span class="st">"DIVERTED"</span>]]<span class="op">\</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>.agg([np.<span class="bu">sum</span>,np.mean])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">DIVERTED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
<td>0.032106</td>
<td>6</td>
<td>0.004699</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>0.007341</td>
<td>2</td>
<td>0.001631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
<td>0.011949</td>
<td>2</td>
<td>0.001494</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
<td>0.015004</td>
<td>5</td>
<td>0.003751</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
<td>0.014151</td>
<td>1</td>
<td>0.000786</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>0.014118</td>
<td>2</td>
<td>0.001569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
<td>0.007911</td>
<td>4</td>
<td>0.003165</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
<td>0.005828</td>
<td>0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
<td>0.010132</td>
<td>3</td>
<td>0.003040</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>0.006066</td>
<td>3</td>
<td>0.002600</td>
</tr>
</tbody>
</table>

<p>98 rows × 4 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div id="0741f468-2736-4fb5-8417-716113dee537" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])[[<span class="st">"CANCELLED"</span>,<span class="st">"DIVERTED"</span>]]<span class="op">\</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>.agg([<span class="st">"sum"</span>,<span class="st">"mean"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">DIVERTED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
<td>0.032106</td>
<td>6</td>
<td>0.004699</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>0.007341</td>
<td>2</td>
<td>0.001631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
<td>0.011949</td>
<td>2</td>
<td>0.001494</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
<td>0.015004</td>
<td>5</td>
<td>0.003751</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
<td>0.014151</td>
<td>1</td>
<td>0.000786</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>0.014118</td>
<td>2</td>
<td>0.001569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
<td>0.007911</td>
<td>4</td>
<td>0.003165</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
<td>0.005828</td>
<td>0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
<td>0.010132</td>
<td>3</td>
<td>0.003040</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>0.006066</td>
<td>3</td>
<td>0.002600</td>
</tr>
</tbody>
</table>

<p>98 rows × 4 columns</p>
</div>
</div>
</div>
<p>(예시3) - 사용불가</p>
</section>
<section id="ex4-airlineweekday-to-cancelledsummeancount-air_time-meanvar" class="level3">
<h3 class="anchored" data-anchor-id="ex4-airlineweekday-to-cancelledsummeancount-air_time-meanvar">EX4: [AIRLINE,WEEKDAY] <span class="math inline">\(\to\)</span> {CANCELLED:sum,mean,count}, {AIR_TIME: mean,var}</h3>
<p>방법2 불가</p>
<p><code>-</code> 방법1</p>
<p>(예시1)</p>
<div id="2f9a5818-adc7-4991-858b-832d008186a6" class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">'AIRLINE'</span>,<span class="st">'WEEKDAY'</span>])<span class="op">\</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>.agg({<span class="st">'CANCELLED'</span>:[np.<span class="bu">sum</span>,np.mean,<span class="bu">len</span>], <span class="st">'AIR_TIME'</span>:[np.mean,np.var]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="165">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">AIR_TIME</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">len</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">var</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
<td>0.032106</td>
<td>1277</td>
<td>147.610569</td>
<td>5393.806723</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>0.007341</td>
<td>1226</td>
<td>143.851852</td>
<td>5359.890719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
<td>0.011949</td>
<td>1339</td>
<td>144.514005</td>
<td>5378.854539</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
<td>0.015004</td>
<td>1333</td>
<td>141.124618</td>
<td>4791.524627</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
<td>0.014151</td>
<td>1272</td>
<td>145.430966</td>
<td>5884.592076</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>0.014118</td>
<td>1275</td>
<td>104.219920</td>
<td>2901.873447</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
<td>0.007911</td>
<td>1264</td>
<td>107.200800</td>
<td>2966.568935</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
<td>0.005828</td>
<td>1201</td>
<td>107.893635</td>
<td>3268.717093</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
<td>0.010132</td>
<td>987</td>
<td>109.247433</td>
<td>3152.753719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>0.006066</td>
<td>1154</td>
<td>107.602273</td>
<td>3183.126889</td>
</tr>
</tbody>
</table>

<p>98 rows × 5 columns</p>
</div>
</div>
</div>
<p>(예시2)</p>
<div id="9b07e827-8c95-4761-b4e4-ac1681669ccb" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">'AIRLINE'</span>,<span class="st">'WEEKDAY'</span>])<span class="op">\</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>.agg({<span class="st">'CANCELLED'</span>:[<span class="bu">sum</span>,mean,size], <span class="st">'AIR_TIME'</span>:[mean<span class="st">","</span>var<span class="st">"]})</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="er"># 그 전에서는 큰 따옴표 없이도 다 됬는데, 여기서는 size 정의가 안 되어 있다고 나온다. 그래서 큰 따옴표를 해줘야 함!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">AIR_TIME</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">size</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">var</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
<td>0.032106</td>
<td>1277</td>
<td>147.610569</td>
<td>5393.806723</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>0.007341</td>
<td>1226</td>
<td>143.851852</td>
<td>5359.890719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
<td>0.011949</td>
<td>1339</td>
<td>144.514005</td>
<td>5378.854539</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
<td>0.015004</td>
<td>1333</td>
<td>141.124618</td>
<td>4791.524627</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
<td>0.014151</td>
<td>1272</td>
<td>145.430966</td>
<td>5884.592076</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>0.014118</td>
<td>1275</td>
<td>104.219920</td>
<td>2901.873447</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
<td>0.007911</td>
<td>1264</td>
<td>107.200800</td>
<td>2966.568935</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
<td>0.005828</td>
<td>1201</td>
<td>107.893635</td>
<td>3268.717093</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
<td>0.010132</td>
<td>987</td>
<td>109.247433</td>
<td>3152.753719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>0.006066</td>
<td>1154</td>
<td>107.602273</td>
<td>3183.126889</td>
</tr>
</tbody>
</table>

<p>98 rows × 5 columns</p>
</div>
</div>
</div>
<p>(사용자정의함수)</p>
<div id="59c56e83-1006-4d04-acdd-30020d803aba" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>df.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"WEEKDAY"</span>])<span class="op">\</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>.agg({<span class="st">'CANCELLED'</span>:[np.<span class="bu">sum</span>,np.mean,<span class="bu">len</span>],</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">'AIR_TIME'</span>:[np.mean,<span class="kw">lambda</span> x: np.std(x,ddof<span class="op">=</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">AIR_TIME</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">len</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">&lt;lambda_0&gt;</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">WEEKDAY</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">1</td>
<td>41</td>
<td>0.032106</td>
<td>1277</td>
<td>147.610569</td>
<td>5393.806723</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>0.007341</td>
<td>1226</td>
<td>143.851852</td>
<td>5359.890719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
<td>0.011949</td>
<td>1339</td>
<td>144.514005</td>
<td>5378.854539</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
<td>0.015004</td>
<td>1333</td>
<td>141.124618</td>
<td>4791.524627</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>18</td>
<td>0.014151</td>
<td>1272</td>
<td>145.430966</td>
<td>5884.592076</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">3</td>
<td>18</td>
<td>0.014118</td>
<td>1275</td>
<td>104.219920</td>
<td>2901.873447</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>10</td>
<td>0.007911</td>
<td>1264</td>
<td>107.200800</td>
<td>2966.568935</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>7</td>
<td>0.005828</td>
<td>1201</td>
<td>107.893635</td>
<td>3268.717093</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>10</td>
<td>0.010132</td>
<td>987</td>
<td>109.247433</td>
<td>3152.753719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>0.006066</td>
<td>1154</td>
<td>107.602273</td>
<td>3183.126889</td>
</tr>
</tbody>
</table>

<p>98 rows × 5 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="연속형-변수를-기준으로-groupby---agg" class="level2">
<h2 class="anchored" data-anchor-id="연속형-변수를-기준으로-groupby---agg">연속형 변수를 기준으로 groupby -&gt; agg</h2>
<div id="f38cf973-4515-48b2-a9e1-5e85a9cfdb50" class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>df.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="171">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">58482</th>
<th data-quarto-table-cell-role="th">58483</th>
<th data-quarto-table-cell-role="th">58484</th>
<th data-quarto-table-cell-role="th">58485</th>
<th data-quarto-table-cell-role="th">58486</th>
<th data-quarto-table-cell-role="th">58487</th>
<th data-quarto-table-cell-role="th">58488</th>
<th data-quarto-table-cell-role="th">58489</th>
<th data-quarto-table-cell-role="th">58490</th>
<th data-quarto-table-cell-role="th">58491</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">MONTH</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DAY</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>...</td>
<td>31</td>
<td>31</td>
<td>31</td>
<td>31</td>
<td>31</td>
<td>31</td>
<td>31</td>
<td>31</td>
<td>31</td>
<td>31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">WEEKDAY</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AIRLINE</td>
<td>WN</td>
<td>UA</td>
<td>MQ</td>
<td>AA</td>
<td>WN</td>
<td>UA</td>
<td>AA</td>
<td>F9</td>
<td>AA</td>
<td>UA</td>
<td>...</td>
<td>OO</td>
<td>B6</td>
<td>MQ</td>
<td>DL</td>
<td>EV</td>
<td>AA</td>
<td>F9</td>
<td>OO</td>
<td>WN</td>
<td>OO</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ORG_AIR</td>
<td>LAX</td>
<td>DEN</td>
<td>DFW</td>
<td>DFW</td>
<td>LAX</td>
<td>IAH</td>
<td>DFW</td>
<td>SFO</td>
<td>ORD</td>
<td>IAH</td>
<td>...</td>
<td>DEN</td>
<td>PHX</td>
<td>ORD</td>
<td>ATL</td>
<td>DFW</td>
<td>SFO</td>
<td>LAS</td>
<td>SFO</td>
<td>MSP</td>
<td>SFO</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DEST_AIR</td>
<td>SLC</td>
<td>IAD</td>
<td>VPS</td>
<td>DCA</td>
<td>MCI</td>
<td>SAN</td>
<td>MSY</td>
<td>PHX</td>
<td>STL</td>
<td>SJC</td>
<td>...</td>
<td>CPR</td>
<td>BOS</td>
<td>DSM</td>
<td>CMH</td>
<td>LFT</td>
<td>DFW</td>
<td>SFO</td>
<td>SBA</td>
<td>ATL</td>
<td>BOI</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SCHED_DEP</td>
<td>1625</td>
<td>823</td>
<td>1305</td>
<td>1555</td>
<td>1720</td>
<td>1450</td>
<td>1250</td>
<td>1020</td>
<td>1845</td>
<td>925</td>
<td>...</td>
<td>1850</td>
<td>2236</td>
<td>1333</td>
<td>2206</td>
<td>850</td>
<td>515</td>
<td>1910</td>
<td>1846</td>
<td>525</td>
<td>859</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DEP_DELAY</td>
<td>58.0</td>
<td>7.0</td>
<td>36.0</td>
<td>7.0</td>
<td>48.0</td>
<td>1.0</td>
<td>84.0</td>
<td>-7.0</td>
<td>-5.0</td>
<td>3.0</td>
<td>...</td>
<td>-2.0</td>
<td>-12.0</td>
<td>1.0</td>
<td>2.0</td>
<td>21.0</td>
<td>5.0</td>
<td>13.0</td>
<td>-6.0</td>
<td>39.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIR_TIME</td>
<td>94.0</td>
<td>154.0</td>
<td>85.0</td>
<td>126.0</td>
<td>166.0</td>
<td>178.0</td>
<td>64.0</td>
<td>91.0</td>
<td>44.0</td>
<td>215.0</td>
<td>...</td>
<td>38.0</td>
<td>231.0</td>
<td>57.0</td>
<td>64.0</td>
<td>52.0</td>
<td>166.0</td>
<td>71.0</td>
<td>46.0</td>
<td>124.0</td>
<td>73.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">DIST</td>
<td>590</td>
<td>1452</td>
<td>641</td>
<td>1192</td>
<td>1363</td>
<td>1303</td>
<td>447</td>
<td>651</td>
<td>258</td>
<td>1608</td>
<td>...</td>
<td>230</td>
<td>2300</td>
<td>299</td>
<td>447</td>
<td>351</td>
<td>1464</td>
<td>414</td>
<td>262</td>
<td>907</td>
<td>522</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SCHED_ARR</td>
<td>1905</td>
<td>1333</td>
<td>1453</td>
<td>1935</td>
<td>2225</td>
<td>1620</td>
<td>1410</td>
<td>1315</td>
<td>1950</td>
<td>1136</td>
<td>...</td>
<td>1956</td>
<td>515</td>
<td>1455</td>
<td>2338</td>
<td>1012</td>
<td>1045</td>
<td>2050</td>
<td>1956</td>
<td>855</td>
<td>1146</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ARR_DELAY</td>
<td>65.0</td>
<td>-13.0</td>
<td>35.0</td>
<td>-7.0</td>
<td>39.0</td>
<td>-14.0</td>
<td>83.0</td>
<td>-6.0</td>
<td>-5.0</td>
<td>-14.0</td>
<td>...</td>
<td>1.0</td>
<td>-45.0</td>
<td>-7.0</td>
<td>-8.0</td>
<td>14.0</td>
<td>-19.0</td>
<td>4.0</td>
<td>-5.0</td>
<td>34.0</td>
<td>-1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DIVERTED</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CANCELLED</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>14 rows × 58492 columns</p>
</div>
</div>
</div>
<div id="2f41e761-5e55-4060-9602-8b0695d4e242" class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>df.DIST.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="172">
<pre><code>count    58492.000000
mean       872.900072
std        624.996805
min         67.000000
25%        391.000000
50%        690.000000
75%       1199.000000
max       4502.000000
Name: DIST, dtype: float64</code></pre>
</div>
</div>
<div id="bec9e32f-5528-4b2f-98e6-c076938bf527" class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>df.assign(DIST2 <span class="op">=</span> pd.cut(df.DIST,[<span class="op">-</span>np.inf,<span class="dv">391</span>,<span class="dv">690</span>,<span class="dv">1199</span>,np.inf]))<span class="op">\</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"DIST2"</span>]).agg({<span class="st">'CANCELLED'</span>:[<span class="st">"sum"</span>,<span class="st">"mean"</span>,<span class="st">"count"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">DIST2</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>18</td>
<td>0.015986</td>
<td>1126</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>17</td>
<td>0.013589</td>
<td>1251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>69</td>
<td>0.022066</td>
<td>3127</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>50</td>
<td>0.014723</td>
<td>3396</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">AS</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>0</td>
<td>0.000000</td>
<td>145</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>0</td>
<td>0.000000</td>
<td>462</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>0</td>
<td>0.000000</td>
<td>161</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">B6</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>0</td>
<td>0.000000</td>
<td>71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>0</td>
<td>0.000000</td>
<td>38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>0</td>
<td>0.000000</td>
<td>61</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>1</td>
<td>0.002681</td>
<td>373</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">DL</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>7</td>
<td>0.003086</td>
<td>2268</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>8</td>
<td>0.002421</td>
<td>3304</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>16</td>
<td>0.006405</td>
<td>2498</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>7</td>
<td>0.002766</td>
<td>2531</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">EV</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>77</td>
<td>0.028785</td>
<td>2675</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>47</td>
<td>0.022793</td>
<td>2062</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>22</td>
<td>0.019982</td>
<td>1101</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>0</td>
<td>0.000000</td>
<td>20</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">F9</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>0</td>
<td>0.000000</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>6</td>
<td>0.013825</td>
<td>434</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>4</td>
<td>0.007105</td>
<td>563</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>0</td>
<td>0.000000</td>
<td>293</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">HA</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>0</td>
<td>0.000000</td>
<td>112</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">MQ</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>90</td>
<td>0.047120</td>
<td>1910</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>39</td>
<td>0.037356</td>
<td>1044</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>22</td>
<td>0.044266</td>
<td>497</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>1</td>
<td>0.050000</td>
<td>20</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">NK</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>5</td>
<td>0.036496</td>
<td>137</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>4</td>
<td>0.013201</td>
<td>303</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>6</td>
<td>0.011029</td>
<td>544</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>10</td>
<td>0.018797</td>
<td>532</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">OO</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>75</td>
<td>0.024826</td>
<td>3021</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>39</td>
<td>0.019364</td>
<td>2014</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>19</td>
<td>0.016351</td>
<td>1162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>9</td>
<td>0.023018</td>
<td>391</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">UA</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>5</td>
<td>0.007143</td>
<td>700</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>14</td>
<td>0.011824</td>
<td>1184</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>26</td>
<td>0.010924</td>
<td>2380</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>48</td>
<td>0.013605</td>
<td>3528</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">US</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>0</td>
<td>0.000000</td>
<td>254</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>7</td>
<td>0.021944</td>
<td>319</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>2</td>
<td>0.006329</td>
<td>316</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>12</td>
<td>0.016529</td>
<td>726</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">VX</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>2</td>
<td>0.008299</td>
<td>241</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>1</td>
<td>0.003861</td>
<td>259</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>0</td>
<td>0.000000</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>3</td>
<td>0.006369</td>
<td>471</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">(-inf, 391.0]</td>
<td>55</td>
<td>0.023810</td>
<td>2310</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(391.0, 690.0]</td>
<td>14</td>
<td>0.006487</td>
<td>2158</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">(690.0, 1199.0]</td>
<td>17</td>
<td>0.007896</td>
<td>2153</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">(1199.0, inf]</td>
<td>7</td>
<td>0.003895</td>
<td>1797</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>cut과 관련된 설명: https://seong6496.tistory.com/247 참고</p>
<div id="c644ca47-f698-464f-a59b-60784538faa6" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>df.assign(DIST2 <span class="op">=</span> pd.cut(df.DIST,[<span class="op">-</span>np.inf,<span class="dv">400</span>,<span class="dv">700</span>,<span class="dv">1200</span>,np.inf],labels<span class="op">=</span>[<span class="st">'~400'</span>,<span class="st">'400~700'</span>,<span class="st">'700~1200'</span>,<span class="st">'1200~'</span>]))<span class="op">\</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>.groupby([<span class="st">"AIRLINE"</span>,<span class="st">"DIST2"</span>]).agg({<span class="st">'CANCELLED'</span>:[<span class="st">"sum"</span>,<span class="st">"mean"</span>,<span class="st">"count"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="3" data-quarto-table-cell-role="th" data-halign="left">CANCELLED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sum</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">AIRLINE</th>
<th data-quarto-table-cell-role="th">DIST2</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">AA</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>18</td>
<td>0.015986</td>
<td>1126</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>17</td>
<td>0.013589</td>
<td>1251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>69</td>
<td>0.022066</td>
<td>3127</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>50</td>
<td>0.014723</td>
<td>3396</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">AS</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>0</td>
<td>0.000000</td>
<td>145</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>0</td>
<td>0.000000</td>
<td>462</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>0</td>
<td>0.000000</td>
<td>161</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">B6</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>0</td>
<td>0.000000</td>
<td>71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>0</td>
<td>0.000000</td>
<td>38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>0</td>
<td>0.000000</td>
<td>61</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>1</td>
<td>0.002681</td>
<td>373</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">DL</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>7</td>
<td>0.003040</td>
<td>2303</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>8</td>
<td>0.002352</td>
<td>3402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>16</td>
<td>0.006765</td>
<td>2365</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>7</td>
<td>0.002766</td>
<td>2531</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">EV</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>77</td>
<td>0.027838</td>
<td>2766</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>48</td>
<td>0.023312</td>
<td>2059</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>21</td>
<td>0.020731</td>
<td>1013</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>0</td>
<td>0.000000</td>
<td>20</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">F9</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>0</td>
<td>0.000000</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>7</td>
<td>0.015837</td>
<td>442</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>3</td>
<td>0.005405</td>
<td>555</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>0</td>
<td>0.000000</td>
<td>293</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">HA</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>0</td>
<td>0.000000</td>
<td>112</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">MQ</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>92</td>
<td>0.047472</td>
<td>1938</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>39</td>
<td>0.035682</td>
<td>1093</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>20</td>
<td>0.047619</td>
<td>420</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>1</td>
<td>0.050000</td>
<td>20</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">NK</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>5</td>
<td>0.036496</td>
<td>137</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>4</td>
<td>0.013201</td>
<td>303</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>6</td>
<td>0.011029</td>
<td>544</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>10</td>
<td>0.018797</td>
<td>532</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">OO</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>76</td>
<td>0.024837</td>
<td>3060</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>38</td>
<td>0.018673</td>
<td>2035</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>19</td>
<td>0.017241</td>
<td>1102</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>9</td>
<td>0.023018</td>
<td>391</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">UA</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>5</td>
<td>0.006993</td>
<td>715</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>14</td>
<td>0.011966</td>
<td>1170</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>26</td>
<td>0.010929</td>
<td>2379</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>48</td>
<td>0.013605</td>
<td>3528</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">US</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>0</td>
<td>0.000000</td>
<td>254</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>7</td>
<td>0.021944</td>
<td>319</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>2</td>
<td>0.006329</td>
<td>316</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>12</td>
<td>0.016529</td>
<td>726</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">VX</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>2</td>
<td>0.008299</td>
<td>241</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>1</td>
<td>0.003861</td>
<td>259</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>0</td>
<td>0.000000</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>3</td>
<td>0.006369</td>
<td>471</td>
</tr>
<tr class="odd">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">WN</td>
<td data-quarto-table-cell-role="th">~400</td>
<td>55</td>
<td>0.023022</td>
<td>2389</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">400~700</td>
<td>17</td>
<td>0.007795</td>
<td>2181</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">700~1200</td>
<td>14</td>
<td>0.006826</td>
<td>2051</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1200~</td>
<td>7</td>
<td>0.003895</td>
<td>1797</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>